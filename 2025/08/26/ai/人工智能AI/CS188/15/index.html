<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="ZaynPei">
    
    <!-- Completely eliminate flash of wrong theme -->
    <script>
        (function() {
            const THEME_KEY = "REDEFINE-THEME-STATUS";
            const DARK = "dark", LIGHT = "light";
            
            // Get preferred theme
            function getTheme() {
                try {
                    const saved = localStorage.getItem(THEME_KEY);
                    if (saved) {
                        const { isDark } = JSON.parse(saved);
                        return isDark ? DARK : LIGHT;
                    }
                } catch (e) {}
                
                return matchMedia("(prefers-color-scheme: dark)").matches ? DARK : LIGHT;
            }
            
            // Apply theme to document
            function applyTheme(theme) {
                const isDark = theme === DARK;
                const root = document.documentElement;
                
                // Set data attribute for CSS variables
                root.setAttribute("data-theme", theme);
                
                // Set classes for compatibility
                root.classList.add(theme);
                root.classList.remove(isDark ? LIGHT : DARK);
                root.style.colorScheme = theme;
            }
            
            // Initial application
            const theme = getTheme();
            applyTheme(theme);
            
            // Listen for system preference changes
            matchMedia("(prefers-color-scheme: dark)").addEventListener("change", ({ matches }) => {
                // Only update if using system preference (no localStorage entry)
                if (!localStorage.getItem(THEME_KEY)) {
                    applyTheme(matches ? DARK : LIGHT);
                }
            });
            
            // Set body classes once DOM is ready
            if (document.readyState !== "loading") {
                document.body.classList.add(theme + "-mode");
            } else {
                document.addEventListener("DOMContentLoaded", () => {
                    document.body.classList.add(theme + "-mode");
                    document.body.classList.remove((theme === DARK ? LIGHT : DARK) + "-mode");
                });
            }
        })();
    </script>
    
    <!-- Critical CSS to prevent flash -->
    <style>
        :root[data-theme="dark"] {
            --background-color: #202124;
            --background-color-transparent: rgba(32, 33, 36, 0.6);
            --second-background-color: #2d2e32;
            --third-background-color: #34353a;
            --third-background-color-transparent: rgba(32, 33, 36, 0.6);
            --primary-color: #0066CC;
            --first-text-color: #ffffff;
            --second-text-color: #eeeeee;
            --third-text-color: #bebec6;
            --fourth-text-color: #999999;
            --default-text-color: #bebec6;
            --invert-text-color: #373D3F;
            --border-color: rgba(255, 255, 255, 0.08);
            --selection-color: #0066CC;
            --shadow-color-1: rgba(255, 255, 255, 0.08);
            --shadow-color-2: rgba(255, 255, 255, 0.05);
        }
        
        :root[data-theme="light"] {
            --background-color: #fff;
            --background-color-transparent: rgba(255, 255, 255, 0.6);
            --second-background-color: #f8f8f8;
            --third-background-color: #f2f2f2;
            --third-background-color-transparent: rgba(241, 241, 241, 0.6);
            --primary-color: #0066CC;
            --first-text-color: #16171a;
            --second-text-color: #2f3037;
            --third-text-color: #5e5e5e;
            --fourth-text-color: #eeeeee;
            --default-text-color: #373D3F;
            --invert-text-color: #bebec6;
            --border-color: rgba(0, 0, 0, 0.08);
            --selection-color: #0066CC;
            --shadow-color-1: rgba(0, 0, 0, 0.08);
            --shadow-color-2: rgba(0, 0, 0, 0.05);
        }
        
        body {
            background-color: var(--background-color);
            color: var(--default-text-color);
        }
        
        /* Apply body classes as soon as DOM is ready */
        :root[data-theme="dark"] body {
            background-color: var(--background-color);
            color: var(--default-text-color);
        }
    </style>
    
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://zaynpei.github.io/2025/08/26/ai/人工智能ai/cs188/15/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:type" content="article">
<meta property="og:title" content="HMMs (Forward Algorithm, Viterbi Algorithm)(15)">
<meta property="og:url" content="https://zaynpei.github.io/2025/08/26/ai/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BDAI/CS188/15/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://zaynpei.github.io/images/redefine-og.webp">
<meta property="article:published_time" content="2025-08-26T12:00:00.000Z">
<meta property="article:modified_time" content="2025-08-27T06:57:08.186Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="AI">
<meta property="article:tag" content="CS188">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zaynpei.github.io/images/redefine-og.webp">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/icons%E7%81%AF%E5%A1%94.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/icons%E7%81%AF%E5%A1%94.png">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/icons%E7%81%AF%E5%A1%94.png">
    <!--- Page Info-->
    
    <title>
        
            HMMs (Forward Algorithm, Viterbi Algorithm)(15) | ZaynPei&#39;s Base
        
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    
        
            
    
            
    
            
                
                    <link rel="stylesheet" href="/css/custom.css">
                
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/css/build/tailwind.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
        <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    
        <link href="https://cdn.jsdelivr.net/npm/@callmebill/lxgw-wenkai-web@1.320/style.css" rel="stylesheet">
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"zaynpei.github.io","root":"/","language":"en","path":"search.json"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"default","dark":"a11y-dark"},"font":{"enable":true,"family":"'JetBrains Mono', monospace","url":"https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap"}},"toc":{"enable":true,"max_depth":6,"number":false,"expand":true,"init_open":true},"copyright":{"enable":false,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":false,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]},"font":{"enable":true,"url":"https://cdn.jsdelivr.net/npm/@callmebill/lxgw-wenkai-web@1.320/style.css","family":"'LXGW WenKai', sans-serif"}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":true,"family":"'LXGW WenKai', sans-serif","url":"https://cdn.jsdelivr.net/npm/@callmebill/lxgw-wenkai-web@1.320/style.css"},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":false,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"side_tools":{"gear_rotation":true,"auto_expand":false},"open_graph":{"enable":true,"image":"/images/redefine-og.webp","description":"Hexo Theme Redefine, Redefine Your Hexo Journey."},"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"For ourselves","subtitle":{"text":["For yourself"],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"style":"default","links":{"github":null,"instagram":null,"zhihu":null,"twitter":null,"email":null},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.8.5","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"ai":{"path":"docs/ai/","icon":"fa-regular fa-robot"},"algorithms":{"path":"docs/algorithms/","icon":"fa-regular fa-code"},"language":{"path":"docs/lang/","icon":"fa-regular fa-language"},"system":{"path":"docs/system/","icon":"fa-regular fa-desktop"},"web":{"path":"docs/web/","icon":"fa-regular fa-globe"},"misc":{"path":"docs/misc/","icon":"fa-regular fa-boxes-stacked"},"tools":{"path":"docs/tools/","icon":"fa-regular fa-wrench"}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":null},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2025/6/25 13:20:00"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>



<body>
	<div class="progress-bar-container">
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
                <a class="logo-image h-8 w-8 sm:w-10 sm:h-10 mr-3" href="/">
                    <img src="/images/icons%E7%81%AF%E5%A1%94.png" class="w-full h-full rounded-xs">
                </a>
            
            <a class="logo-title" href="/">
                
                ZaynPei&#39;s Base
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    HOME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/docs/ai/"
                                        >
                                    <i class="fa-regular fa-robot fa-fw"></i>
                                    AI
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/docs/algorithms/"
                                        >
                                    <i class="fa-regular fa-code fa-fw"></i>
                                    ALGORITHMS
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/docs/lang/"
                                        >
                                    <i class="fa-regular fa-language fa-fw"></i>
                                    LANGUAGE
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/docs/system/"
                                        >
                                    <i class="fa-regular fa-desktop fa-fw"></i>
                                    SYSTEM
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/docs/web/"
                                        >
                                    <i class="fa-regular fa-globe fa-fw"></i>
                                    WEB
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/docs/misc/"
                                        >
                                    <i class="fa-regular fa-boxes-stacked fa-fw"></i>
                                    MISC
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/docs/tools/"
                                        >
                                    <i class="fa-regular fa-wrench fa-fw"></i>
                                    TOOLS
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                HOME
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/docs/ai/"
                        >
                            <span>
                                AI
                            </span>
                            
                                <i class="fa-regular fa-robot fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/docs/algorithms/"
                        >
                            <span>
                                ALGORITHMS
                            </span>
                            
                                <i class="fa-regular fa-code fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/docs/lang/"
                        >
                            <span>
                                LANGUAGE
                            </span>
                            
                                <i class="fa-regular fa-language fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/docs/system/"
                        >
                            <span>
                                SYSTEM
                            </span>
                            
                                <i class="fa-regular fa-desktop fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/docs/web/"
                        >
                            <span>
                                WEB
                            </span>
                            
                                <i class="fa-regular fa-globe fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/docs/misc/"
                        >
                            <span>
                                MISC
                            </span>
                            
                                <i class="fa-regular fa-boxes-stacked fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/docs/tools/"
                        >
                            <span>
                                TOOLS
                            </span>
                            
                                <i class="fa-regular fa-wrench fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            

            
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">19</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">21</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">186</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">HMMs (Forward Algorithm, Viterbi Algorithm)(15)</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="/images/redefine-avatar.svg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">ZaynPei</span>
					
					<span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv6</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-08-26 20:00</span>
        <span class="mobile">2025-08-26 20:00</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-08-27 14:57:08</span>
            <span class="mobile">2025-08-27 14:57:08</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/AI/">AI</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/AI/">AI</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/CS188/">CS188</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-typewriter"></i>&nbsp;<span>5.1k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fa-regular fa-clock"></i>&nbsp;<span>19 Mins</span>
        </span>
    
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<p>上一讲我们学习了如何对一个状态完全可观察的、随时间演化的系统进行建模和预测。然而，在现实世界中，我们往往无法直接观察到系统的真实状态，只能通过一些间接的、带有噪声的观测来进行推断。</p>
<p>这一讲的核心就是解决这个问题：当系统的真实状态是“隐藏”的时，我们如何通过一系列的观测证据来推断这个隐藏状态？
这个强大的工具就是隐马尔可夫模型 (Hidden Markov Models - HMMs)。</p>
<blockquote>
<p>马尔可夫模型 (Markov Model)：我们能直接看到每天的天气（状态）。
隐马尔可夫模型 (Hidden Markov
Model)：我们看不到真实的天气（状态是隐藏的），但我们每天能看到天气预报（证据/观测）。我们需要根据天气预报来推断真实的天气。</p>
</blockquote>
<h2 id="隐马尔可夫模型-hidden-markov-models">隐马尔可夫模型 (Hidden
Markov Models)</h2>
<p><img lazyload src="/images/loading.svg" data-src="20250826142844.png"></p>
<p>HMM 在马尔可夫模型的基础上，增加了一层可观测的证据变量 (evidence
variable)****</p>
<ul>
<li><p>状态变量 (State Variable)：<span class="math inline"><em>W</em><sub><em>i</em></sub></span>，代表在时间 i
的隐藏状态（例如，真实天气）。</p></li>
<li><p>证据变量 (Evidence Variable)：<span class="math inline"><em>F</em><sub><em>i</em></sub></span>，代表在时间 i
的可观测证据（例如，天气预报）。</p></li>
</ul>
<p>因此, 一个平稳的 HMM 可以由三个部分紧凑地表示：</p>
<ul>
<li><p>初始分布：<span class="math inline"><em>P</em>(<em>W</em><sub>0</sub>)</span>，和马尔可夫模型一样。</p></li>
<li><p>转移模型：<span class="math inline"><em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>|<em>W</em><sub><em>i</em></sub>)</span>，和马尔可夫模型一样。</p></li>
<li><p>传感器模型 (Sensor Model)：<span class="math inline"><em>P</em>(<em>F</em><sub><em>i</em></sub>|<em>W</em><sub><em>i</em></sub>)</span>，这是新增的部分。它描述了在给定真实状态
Wᵢ 的情况下，观测到证据 Fᵢ 的概率。</p></li>
</ul>
<p>另一方面, 对于HMM模型, 由于我们往往无法直接得到隐藏状态,
所以更关注两个概念:</p>
<ul>
<li><p>置信度 (Belief) B(Wₜ): 在观测到截至时刻 t 的所有证据后，对状态 Wₜ
的概率分布。即, B(Wₜ) = P(Wₜ|f₁,…,fₜ)</p></li>
<li><p>预测置信度 (Predicted Belief) B’(Wₜ): 在观测到截至时刻 t-1
的证据后，对状态 Wₜ 的概率分布。即, B’(Wₜ) = P(Wₜ|f₁,…,fₜ₋₁)</p></li>
</ul>
<p>更多时候, 我们使用 <span class="math inline"><em>λ</em> = (<em>A</em>, <em>B</em>, <em>π</em>)</span>
代表整个HMM, 其中: - A：<strong>状态转移</strong>概率矩阵,
表示从一个隐藏状态转移到另一个隐藏状态的概率。 - 如果有 N 个隐藏状态，A
是一个 N×N 的矩阵，其中 A[i][j] 表示从状态 i 转移到状态 j 的概率。 -
B：<strong>观测概率</strong>矩阵（或称发射概率矩阵）:
表示在某个隐藏状态下，生成某个观测值的概率。 - 如果有 M
个可能的观测值，B 是一个 N×M 的矩阵，其中 B[i][k] 表示在隐藏状态 i
下观察到观测值 k 的概率。 - π：<strong>初始状态概率向量</strong>:
表示系统在时间 t=1 时处于每个隐藏状态的概率。 - π[i]
是系统一开始处于状态 i 的概率。</p>
<h3 id="前向算法">前向算法</h3>
<p>在隐马尔可夫模型中，我们拥有一系列随时间变化的、不可直接观测的<strong>隐藏状态</strong>（例如，每天的真实天气
<span class="math inline"><em>W</em><sub><em>t</em></sub></span>），以及在每个时间点上可以观测到的<strong>证据</strong>（例如，天气预报
<span class="math inline"><em>F</em><sub><em>t</em></sub></span>）。</p>
<p>前向算法的核心目标是计算在观测到所有历史证据后，当前隐藏状态的概率分布。这个分布就是我们前面提到的<strong>置信度</strong>（Belief）。换句话说，算法要计算的是
<span class="math inline"><em>P</em>(<em>W</em><sub><em>t</em></sub>|<em>f</em><sub>1</sub>, <em>f</em><sub>2</sub>, ..., <em>f</em><sub><em>t</em></sub>)</span>，即在已知从第1天到第t天的所有天气预报的情况下，第t天真实天气的概率分布。</p>
<p>前向算法通过一个迭代过程，从 <span class="math inline"><em>B</em>(<em>W</em><sub><em>i</em></sub>)</span>
计算出 <span class="math inline"><em>B</em>(<em>W</em><sub><em>i</em> + 1</sub>)</span>。这个过程可以分解为两个关键步骤：<strong>时间流逝更新</strong>(Time
Elapse Update) 和 <strong>观测更新</strong> (Observation Update)</p>
<h4 id="第一步时间流逝更新-time-elapse-update">第一步：时间流逝更新
(Time Elapse Update)</h4>
<p>目标：从当前时刻 i 的置信度 <span class="math inline"><em>B</em>(<em>W</em><sub><em>i</em></sub>)</span>
推导出下一时刻 i+1 的<strong>预测置信度</strong> <span class="math inline"><em>B</em><sup>′</sup>(<em>W</em><sub><em>i</em> + 1</sub>)</span>。这一步相当于在没有看到新证据之前，对未来状态进行预测。</p>
<p>推导过程如下：</p>
<ol type="1">
<li>从定义出发：我们想要求解 <span class="math inline"><em>B</em><sup>′</sup>(<em>W</em><sub><em>i</em> + 1</sub>) = <em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>|<em>f</em><sub>1</sub>, ..., <em>f</em><sub><em>i</em></sub>)</span>。</li>
</ol>
<ul>
<li><p>引入上一时刻的状态 <span class="math inline"><em>W</em><sub><em>i</em></sub></span>：为了将 <span class="math inline"><em>B</em>(<em>W</em><sub><em>i</em></sub>)</span>
引入计算，我们使用边缘化（Marginalization），对 <span class="math inline"><em>W</em><sub><em>i</em></sub></span>
的所有可能取值 <span class="math inline"><em>w</em><sub><em>i</em></sub></span> 进行求和:
<span class="math inline"><em>B</em><sup>′</sup>(<em>W</em><sub><em>i</em> + 1</sub>) = ∑<sub><em>w</em><sub><em>i</em></sub></sub><em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>, <em>w</em><sub><em>i</em></sub>|<em>f</em><sub>1</sub>, ..., <em>f</em><sub><em>i</em></sub>)</span></p></li>
<li><p>这个公式的意义是，“在已知历史证据的情况下，下一状态为 <span class="math inline"><em>W</em><sub><em>i</em> + 1</sub></span>
的概率”等于”在同样证据下，当前状态为某个具体值 <span class="math inline"><em>w</em><sub><em>i</em></sub></span> 且下一状态为
<span class="math inline"><em>W</em><sub><em>i</em> + 1</sub></span>
的所有可能情况的概率之和”。</p></li>
</ul>
<ol start="2" type="1">
<li>应用条件概率的链式法则：将联合概率 <span class="math inline"><em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>, <em>w</em><sub><em>i</em></sub>|...)</span>
分解: <span class="math inline"><em>B</em><sup>′</sup>(<em>W</em><sub><em>i</em> + 1</sub>) = ∑<sub><em>w</em><sub><em>i</em></sub></sub><em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>|<em>w</em><sub><em>i</em></sub>, <em>f</em><sub>1</sub>, ..., <em>f</em><sub><em>i</em></sub>)<em>P</em>(<em>w</em><sub><em>i</em></sub>|<em>f</em><sub>1</sub>, ..., <em>f</em><sub><em>i</em></sub>)</span></li>
</ol>
<ul>
<li><p>这是条件概率的基本性质，将联合概率分解为两个条件的乘积。</p></li>
<li><p>利用HMM的条件独立性假设：HMM假设未来的状态 <span class="math inline"><em>W</em><sub><em>i</em> + 1</sub></span>
仅依赖于当前状态 <span class="math inline"><em>W</em><sub><em>i</em></sub></span>，而与过去的所有证据
<span class="math inline"><em>f</em><sub>1</sub>, ..., <em>f</em><sub><em>i</em></sub></span>
无关。这被称为<strong>马尔可夫性</strong>。</p></li>
<li><p>因此，<span class="math inline"><em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>|<em>w</em><sub><em>i</em></sub>, <em>f</em><sub>1</sub>, ..., <em>f</em><sub><em>i</em></sub>)</span>
可以简化为 <span class="math inline"><em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>|<em>w</em><sub><em>i</em></sub>)</span>，这就是转移模型（Transition
Model）。</p></li>
</ul>
<ol start="3" type="1">
<li>识别置信度：同时，我们发现 <span class="math inline"><em>P</em>(<em>w</em><sub><em>i</em></sub>|<em>f</em><sub>1</sub>, ..., <em>f</em><sub><em>i</em></sub>)</span>
正是当前置信度 <span class="math inline"><em>B</em>(<em>w</em><sub><em>i</em></sub>)</span>
的定义。</li>
</ol>
<ul>
<li><p>得出最终公式：将简化后的项代入，得到时间更新的最终形式: <span class="math inline"><em>B</em><sup>′</sup>(<em>W</em><sub><em>i</em> + 1</sub>) = ∑<sub><em>w</em><sub><em>i</em></sub></sub><em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>|<em>w</em><sub><em>i</em></sub>)<em>B</em>(<em>w</em><sub><em>i</em></sub>)</span></p></li>
<li><p>这个公式表明，对下一状态的预测是所有可能当前状态的置信度 <span class="math inline"><em>B</em>(<em>w</em><sub><em>i</em></sub>)</span>，按照它们各自转移到下一状态的概率
<span class="math inline"><em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>|<em>w</em><sub><em>i</em></sub>)</span>
进行加权求和的结果。</p></li>
</ul>
<h4 id="第二步观测更新-observation-update">第二步：观测更新 (Observation
Update)</h4>
<p>目标：在获得 i+1 时刻的新证据 <span class="math inline"><em>f</em><sub><em>i</em> + 1</sub></span>
后，将<strong>预测置信度</strong> <span class="math inline"><em>B</em><sup>′</sup>(<em>W</em><sub><em>i</em> + 1</sub>)</span>
<strong>更新为真实置信度</strong> <span class="math inline"><em>B</em>(<em>W</em><sub><em>i</em> + 1</sub>)</span>。</p>
<p>推导过程如下：</p>
<ol type="1">
<li>从定义出发：我们想要求解 <span class="math inline"><em>B</em>(<em>W</em><sub><em>i</em> + 1</sub>) = <em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>|<em>f</em><sub>1</sub>, ..., <em>f</em><sub><em>i</em></sub>, <em>f</em><sub><em>i</em> + 1</sub>)</span>。</li>
</ol>
<ul>
<li><p>应用贝叶斯法则（或条件概率定义）：<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -1.238ex;" xmlns="http://www.w3.org/2000/svg" width="26.99ex" height="3.607ex" role="img" focusable="false" viewbox="0 -1047.1 11929.6 1594.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"/></g><g data-mml-node="mo" transform="translate(759,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="msub" transform="translate(1148,0)"><g data-mml-node="mi"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"/></g><g data-mml-node="TeXAtom" transform="translate(977,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g></g></g><g data-mml-node="mo" transform="translate(3322.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(3989.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mfrac" transform="translate(5045.2,0)"><g data-mml-node="mrow" transform="translate(220,516.8) scale(0.707)"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"/></g><g data-mml-node="mo" transform="translate(751,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="msub" transform="translate(1140,0)"><g data-mml-node="mi"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"/></g><g data-mml-node="TeXAtom" transform="translate(977,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g></g></g><g data-mml-node="mo" transform="translate(3314.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"/></g><g data-mml-node="msub" transform="translate(3592.6,0)"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"/></g><g data-mml-node="TeXAtom" transform="translate(523,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g></g></g><g data-mml-node="mo" transform="translate(5313.3,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"/></g><g data-mml-node="msub" transform="translate(5591.3,0)"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"/></g><g data-mml-node="mn" transform="translate(523,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g></g><g data-mml-node="mo" transform="translate(6517.8,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"/></g><g data-mml-node="mo" transform="translate(6795.8,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"/></g><g data-mml-node="mo" transform="translate(7073.8,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"/></g><g data-mml-node="mo" transform="translate(7351.8,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"/></g><g data-mml-node="mo" transform="translate(7629.8,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"/></g><g data-mml-node="msub" transform="translate(7907.8,0)"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"/></g><g data-mml-node="mi" transform="translate(523,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g></g><g data-mml-node="mo" transform="translate(8724.8,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g></g><g data-mml-node="mrow" transform="translate(1087.1,-370.3) scale(0.707)"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"/></g><g data-mml-node="mo" transform="translate(751,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="msub" transform="translate(1140,0)"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"/></g><g data-mml-node="TeXAtom" transform="translate(523,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g></g></g><g data-mml-node="mo" transform="translate(2860.6,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"/></g><g data-mml-node="msub" transform="translate(3138.6,0)"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"/></g><g data-mml-node="mn" transform="translate(523,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g></g><g data-mml-node="mo" transform="translate(4065.2,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"/></g><g data-mml-node="mo" transform="translate(4343.2,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"/></g><g data-mml-node="mo" transform="translate(4621.2,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"/></g><g data-mml-node="mo" transform="translate(4899.2,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"/></g><g data-mml-node="mo" transform="translate(5177.2,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"/></g><g data-mml-node="msub" transform="translate(5455.2,0)"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"/></g><g data-mml-node="mi" transform="translate(523,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g></g><g data-mml-node="mo" transform="translate(6272.1,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g></g><rect width="6644.4" height="60" x="120" y="220"/></g></g></g></svg></mjx-container></span></p></li>
<li><p>我们将求解目标中的条件 <span class="math inline"><em>f</em><sub><em>i</em> + 1</sub></span>
移到分子中，形成一个联合概率。</p></li>
</ul>
<ol start="2" type="1">
<li>引入归一化技巧：分母 <span class="math inline"><em>P</em>(<em>f</em><sub><em>i</em> + 1</sub>|<em>f</em><sub>1</sub>, ..., <em>f</em><sub><em>i</em></sub>)</span>
是一个常数，因为它不随 <span class="math inline"><em>W</em><sub><em>i</em> + 1</sub></span>
的变化而改变。为了简化计算，我们可以暂时忽略它，用比例关系 <span class="math inline">∝</span> 来表示: <span class="math inline"><em>B</em>(<em>W</em><sub><em>i</em> + 1</sub>) ∝ <em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>, <em>f</em><sub><em>i</em> + 1</sub>|<em>f</em><sub>1</sub>, ..., <em>f</em><sub><em>i</em></sub>)</span></li>
</ol>
<ul>
<li><p>这意味着 <span class="math inline"><em>B</em>(<em>W</em><sub><em>i</em> + 1</sub>)</span>
的分布形状由分子决定，我们可以在所有计算完成后再进行归一化，使其概率和为1。</p></li>
<li><p>接着再次应用链式法则：对分子进行分解: <span class="math inline"><em>B</em>(<em>W</em><sub><em>i</em> + 1</sub>) ∝ <em>P</em>(<em>f</em><sub><em>i</em> + 1</sub>|<em>W</em><sub><em>i</em> + 1</sub>, <em>f</em><sub>1</sub>, ..., <em>f</em><sub><em>i</em></sub>)<em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>|<em>f</em><sub>1</sub>, ..., <em>f</em><sub><em>i</em></sub>)</span></p></li>
</ul>
<ol start="3" type="1">
<li>利用HMM的条件独立性假设：HMM假设当前证据 <span class="math inline"><em>f</em><sub><em>i</em> + 1</sub></span>
仅依赖于当前状态 <span class="math inline"><em>W</em><sub><em>i</em> + 1</sub></span>，而与过去的状态和证据无关。</li>
</ol>
<ul>
<li>因此，<span class="math inline"><em>P</em>(<em>f</em><sub><em>i</em> + 1</sub>|<em>W</em><sub><em>i</em> + 1</sub>, <em>f</em><sub>1</sub>, ..., <em>f</em><sub><em>i</em></sub>)</span>
可以简化为 <span class="math inline"><em>P</em>(<em>f</em><sub><em>i</em> + 1</sub>|<em>W</em><sub><em>i</em> + 1</sub>)</span>，这被称为传感器模型（Sensor
Model）。</li>
</ul>
<ol start="4" type="1">
<li>识别预测置信度：同时，我们发现 <span class="math inline"><em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>|<em>f</em><sub>1</sub>, ..., <em>f</em><sub><em>i</em></sub>)</span>
正是我们在第一步中计算出的预测置信度 <span class="math inline"><em>B</em><sup>′</sup>(<em>W</em><sub><em>i</em> + 1</sub>)</span>。</li>
</ol>
<ul>
<li><p>得出最终公式：将简化后的项代入，得到观测更新的最终形式, 即: <span class="math inline"><em>B</em>(<em>W</em><sub><em>i</em> + 1</sub>) ∝ <em>P</em>(<em>f</em><sub><em>i</em> + 1</sub>|<em>W</em><sub><em>i</em> + 1</sub>)<em>B</em><sup>′</sup>(<em>W</em><sub><em>i</em> + 1</sub>)</span></p></li>
<li><p>这个公式的意义是，结合新证据后的置信度，与”预测置信度”和”新证据在该状态下的出现概率”的乘积成正比。如果观测到的证据在某个状态下很可能发生，那么这个状态的置信度就会相应提高。</p></li>
</ul>
<h4 id="前向算法的核心">前向算法的核心</h4>
<p>通过将上述两个步骤结合起来，我们就得到了一个从 <span class="math inline"><em>B</em>(<em>W</em><sub><em>i</em></sub>)</span>
计算 <span class="math inline"><em>B</em>(<em>W</em><sub><em>i</em> + 1</sub>)</span>
的完整迭代公式：</p>
<p><span class="math inline"><em>B</em>(<em>W</em><sub><em>i</em> + 1</sub>) ∝ <em>P</em>(<em>f</em><sub><em>i</em> + 1</sub>|<em>W</em><sub><em>i</em> + 1</sub>)<em>B</em><sup>′</sup>(<em>W</em><sub><em>i</em> + 1</sub>)</span></p>
<p><span class="math inline"><em>B</em>(<em>W</em><sub><em>i</em> + 1</sub>) ∝ <em>P</em>(<em>f</em><sub><em>i</em> + 1</sub>|<em>W</em><sub><em>i</em> + 1</sub>)∑<sub><em>w</em><sub><em>i</em></sub></sub><em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>|<em>w</em><sub><em>i</em></sub>)<em>B</em>(<em>w</em><sub><em>i</em></sub>)</span></p>
<p>这个公式就是前向算法的核心。从初始置信度 <span class="math inline"><em>B</em>(<em>W</em><sub>0</sub>)</span>
开始，我们可以通过这个公式逐步递推，计算出任何时刻 t 的置信度分布 <span class="math inline"><em>B</em>(<em>W</em><sub><em>t</em></sub>)</span>。在计算出每个
<span class="math inline"><em>B</em>(<em>W</em><sub><em>i</em> + 1</sub>)</span>
的非归一化值后，只需将所有可能状态的概率值相加，再用每个值除以这个总和，即可完成归一化，得到最终的概率分布。</p>
<h4 id="示例分析">示例分析</h4>
<p>我们首先需要定义模型的三个核心部分：初始分布、转移模型和传感器模型。</p>
<ul>
<li>初始置信度 <span class="math inline"><em>B</em>(<em>W</em><sub>0</sub>)</span>表示第0天的天气概率分布。</li>
</ul>
<table>
<thead>
<tr>
<th><span class="math inline"><em>W</em><sub>0</sub></span></th>
<th><span class="math inline"><em>B</em>(<em>W</em><sub>0</sub>)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>sun</td>
<td>0.8</td>
</tr>
<tr>
<td>rain</td>
<td>0.2</td>
</tr>
</tbody>
</table>
<ul>
<li>转移模型 <span class="math inline"><em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>|<em>W</em><sub><em>i</em></sub>)</span>表示从今天的天气转移到明天天气的概率。</li>
</ul>
<table>
<thead>
<tr>
<th><span class="math inline"><em>W</em><sub><em>i</em></sub></span></th>
<th><span class="math inline"><em>W</em><sub><em>i</em> + 1</sub></span></th>
<th><span class="math inline"><em>P</em>(<em>W</em><sub><em>i</em> + 1</sub>|<em>W</em><sub><em>i</em></sub>)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>sun</td>
<td>sun</td>
<td>0.6</td>
</tr>
<tr>
<td>sun</td>
<td>rain</td>
<td>0.4</td>
</tr>
<tr>
<td>rain</td>
<td>sun</td>
<td>0.1</td>
</tr>
<tr>
<td>rain</td>
<td>rain</td>
<td>0.9</td>
</tr>
</tbody>
</table>
<ul>
<li>传感器模型 <span class="math inline"><em>P</em>(<em>F</em><sub><em>i</em></sub>|<em>W</em><sub><em>i</em></sub>)</span>表示在某种真实天气下，观测到特定天气预报的概率。</li>
</ul>
<table>
<thead>
<tr>
<th><span class="math inline"><em>W</em><sub><em>i</em></sub></span></th>
<th><span class="math inline"><em>F</em><sub><em>i</em></sub></span></th>
<th><span class="math inline"><em>P</em>(<em>F</em><sub><em>i</em></sub>|<em>W</em><sub><em>i</em></sub>)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>sun</td>
<td>good</td>
<td>0.8</td>
</tr>
<tr>
<td>sun</td>
<td>bad</td>
<td>0.2</td>
</tr>
<tr>
<td>rain</td>
<td>good</td>
<td>0.3</td>
</tr>
<tr>
<td>rain</td>
<td>bad</td>
<td>0.7</td>
</tr>
</tbody>
</table>
<p>我们的目标是计算第1天的置信度 <span class="math inline"><em>B</em>(<em>W</em><sub>1</sub>)</span>，假设我们观测到第1天的天气预报是”good”
<span class="math inline">(<em>f</em><sub>1</sub> = <em>g</em><em>o</em><em>o</em><em>d</em>)</span>。</p>
<p>整个计算过程遵循前向算法的两个核心步骤：时间流逝更新和观测更新。</p>
<p>第一步是时间流逝更新（预测）: 根据第0天的置信度 <span class="math inline"><em>B</em>(<em>W</em><sub>0</sub>)</span>，预测第1天的天气概率分布
<span class="math inline"><em>B</em><sup>′</sup>(<em>W</em><sub>1</sub>)</span>，此时我们尚未考虑第1天的天气预报。</p>
<p>公式为：<span class="math inline"><em>B</em><sup>′</sup>(<em>W</em><sub>1</sub>) = ∑<sub><em>w</em><sub>0</sub></sub><em>P</em>(<em>W</em><sub>1</sub>|<em>w</em><sub>0</sub>)<em>B</em>(<em>w</em><sub>0</sub>)</span></p>
<p>第1天是晴天的预测概率，等于”第0天是晴天且第1天也是晴天”的概率，加上”第0天是雨天但第1天是晴天”的概率。</p>
<p><span class="math inline"><em>B</em><sup>′</sup>(<em>W</em><sub>1</sub> = <em>s</em><em>u</em><em>n</em>) = <em>P</em>(<em>W</em><sub>1</sub> = <em>s</em><em>u</em><em>n</em>|<em>W</em><sub>0</sub> = <em>s</em><em>u</em><em>n</em>)<em>B</em>(<em>W</em><sub>0</sub> = <em>s</em><em>u</em><em>n</em>) + <em>P</em>(<em>W</em><sub>1</sub> = <em>s</em><em>u</em><em>n</em>|<em>W</em><sub>0</sub> = <em>r</em><em>a</em><em>i</em><em>n</em>)<em>B</em>(<em>W</em><sub>0</sub> = <em>r</em><em>a</em><em>i</em><em>n</em>)</span>
<span class="math inline"> = (0.6 · 0.8) + (0.1 · 0.2)</span> <span class="math inline"> = 0.48 + 0.02 = 0.5</span></p>
<p><span class="math inline"><em>B</em><sup>′</sup>(<em>W</em><sub>1</sub> = <em>r</em><em>a</em><em>i</em><em>n</em>) = <em>P</em>(<em>W</em><sub>1</sub> = <em>r</em><em>a</em><em>i</em><em>n</em>|<em>W</em><sub>0</sub> = <em>s</em><em>u</em><em>n</em>)<em>B</em>(<em>W</em><sub>0</sub> = <em>s</em><em>u</em><em>n</em>) + <em>P</em>(<em>W</em><sub>1</sub> = <em>r</em><em>a</em><em>i</em><em>n</em>|<em>W</em><sub>0</sub> = <em>r</em><em>a</em><em>i</em><em>n</em>)<em>B</em>(<em>W</em><sub>0</sub> = <em>r</em><em>a</em><em>i</em><em>n</em>)</span>
<span class="math inline"> = (0.4 · 0.8) + (0.9 · 0.2)</span> <span class="math inline"> = 0.32 + 0.18 = 0.5</span></p>
<p>经过时间更新后，我们得到的预测置信度为：</p>
<table>
<thead>
<tr>
<th><span class="math inline"><em>W</em><sub>1</sub></span></th>
<th><span class="math inline"><em>B</em><sup>′</sup>(<em>W</em><sub>1</sub>)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>sun</td>
<td>0.5</td>
</tr>
<tr>
<td>rain</td>
<td>0.5</td>
</tr>
</tbody>
</table>
<p>这表明，在不考虑任何新证据的情况下，我们预测第1天晴天和雨天的概率各占一半。</p>
<p>第二步是观测更新（修正）: 现在我们引入观测证据 <span class="math inline"><em>f</em><sub>1</sub> = <em>g</em><em>o</em><em>o</em><em>d</em></span>，用它来修正我们的预测，得到最终的置信度
<span class="math inline"><em>B</em>(<em>W</em><sub>1</sub>)</span>。</p>
<p>公式为：<span class="math inline"><em>B</em>(<em>W</em><sub>1</sub>) ∝ <em>P</em>(<em>f</em><sub>1</sub>|<em>W</em><sub>1</sub>)<em>B</em><sup>′</sup>(<em>W</em><sub>1</sub>)</span></p>
<p><span class="math inline"><em>B</em>(<em>W</em><sub>1</sub> = <em>s</em><em>u</em><em>n</em>) ∝ <em>P</em>(<em>F</em><sub>1</sub> = <em>g</em><em>o</em><em>o</em><em>d</em>|<em>W</em><sub>1</sub> = <em>s</em><em>u</em><em>n</em>)<em>B</em><sup>′</sup>(<em>W</em><sub>1</sub> = <em>s</em><em>u</em><em>n</em>)</span>
<span class="math inline"> ∝ 0.8 · 0.5 = 0.4</span></p>
<p><span class="math inline"><em>B</em>(<em>W</em><sub>1</sub> = <em>r</em><em>a</em><em>i</em><em>n</em>) ∝ <em>P</em>(<em>F</em><sub>1</sub> = <em>g</em><em>o</em><em>o</em><em>d</em>|<em>W</em><sub>1</sub> = <em>r</em><em>a</em><em>i</em><em>n</em>)<em>B</em><sup>′</sup>(<em>W</em><sub>1</sub> = <em>r</em><em>a</em><em>i</em><em>n</em>)</span>
<span class="math inline"> ∝ 0.3 · 0.5 = 0.15</span></p>
<p>在第二步之后,
我们得到了未经归一化的置信度值：sun为0.4，rain为0.15。</p>
<p>第三步是归一化,
将上述结果转换为合法的概率分布（即各项概率之和为1）。</p>
<p>计算总和：0.4 + 0.15 = 0.55</p>
<p>归一化： <span class="math inline"><em>B</em>(<em>W</em><sub>1</sub> = <em>s</em><em>u</em><em>n</em>) = 0.4/0.55 = 8/11</span>
<span class="math inline"><em>B</em>(<em>W</em><sub>1</sub> = <em>r</em><em>a</em><em>i</em><em>n</em>) = 0.15/0.55 = 3/11</span></p>
<p>经过完整的计算，我们得到第1天的最终置信度分布 <span class="math inline"><em>B</em>(<em>W</em><sub>1</sub>)</span> 如下：</p>
<table>
<thead>
<tr>
<th><span class="math inline"><em>W</em><sub>1</sub></span></th>
<th><span class="math inline"><em>B</em>(<em>W</em><sub>1</sub>)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>sun</td>
<td>8/11 (≈ 0.727)</td>
</tr>
<tr>
<td>rain</td>
<td>3/11 (≈ 0.273)</td>
</tr>
</tbody>
</table>
<p>最开始，我们对第1天的天气预测是晴雨概率各占50% <span class="math inline">(<em>B</em><sup>′</sup>(<em>W</em><sub>1</sub>))</span>。然而，当我们观测到”预报为good”这个证据后，我们对”第1天是晴天”的信心大大增加，从50%
(1/2) 上升到了约73%
(8/11)。这完全符合直觉，因为晴天时出现”good”预报的概率（0.8）远高于雨天时（0.3）。这个例子清晰地展示了前向算法是如何融合历史信息和当前证据来动态更新对隐藏状态的信念的。</p>
<h3 id="维特比算法viterbi-algorithm">维特比算法（Viterbi
Algorithm）</h3>
<p>前向算法回答的是“在时刻 N，最可能的状态是什么？”。而 Viterbi
算法回答的是一个不同但同样重要的问题：“给定从时刻1到 N
的所有观测，最可能的状态序列是什么？”</p>
<p>换句话说，算法旨在找到一个完整的<strong>隐藏状态序列</strong>（一条路径），使得这个序列在<strong>给定观测证据</strong>的情况下出现的概率最大
。</p>
<p>公式化表达即为寻找最可能的隐藏状态序列 <span class="math inline"><em>x</em><sub>1 : <em>N</em></sub><sup>*</sup></span>。
<span class="math inline"><em>x</em><sub>1 : <em>N</em></sub><sup>*</sup> = arg max<sub><em>x</em><sub>1 : <em>N</em></sub></sub><em>P</em>(<em>x</em><sub>1 : <em>N</em></sub>|<em>e</em><sub>1 : <em>N</em></sub>)</span></p>
<blockquote>
<p>想象一下，你每天都会收到一份天气预报（观测证据），但你无法直接知道每天的真实天气（隐藏状态）。几天过后，你手上有一系列的预报记录，比如“（好，好，坏）”。你现在想推断出这几天最可能发生的真实天气序列是什么。是“（晴，晴，雨）”还是“（晴，雨，雨）”？</p>
</blockquote>
<p>维特比算法采用<strong>动态规划</strong>来解决这个问题。其核心思想可以概括为一句话：</p>
<p>“如果要找在时刻 t 到达状态 A 的最优路径，我们只需要知道在时刻 t-1
到达所有可能前置状态（A, B, C, …）的最优路径即可。”</p>
<p>我们不需要关心到达状态 B 或 C
的完整历史路径是什么，只需要知道它们各自由最优路径到达自己的概率是多少。然后我们就可以计算从
A 到 A, 从 B 到 A 和从 C 到 A 的新得分，选择其中更高分的那条作为到达 A
的最优路径。</p>
<h4 id="基本步骤">基本步骤</h4>
<p>假设我们有一个隐藏马尔可夫模型，它由以下要素组成：</p>
<ul>
<li><p>隐藏状态集合 <span class="math inline"><em>S</em> = {<em>s</em><sub>1</sub>, <em>s</em><sub>2</sub>, ..., <em>s</em><sub><em>N</em></sub>}</span>：我们无法直接观察到的状态。</p></li>
<li><p>观测状态集合 <span class="math inline"><em>O</em> = {<em>o</em><sub>1</sub>, <em>o</em><sub>2</sub>, ..., <em>o</em><sub><em>M</em></sub>}</span>：我们能够直接观察到的结果。</p></li>
<li><p>初始状态概率 <span class="math inline"><em>π</em> = {<em>π</em><sub>1</sub>, <em>π</em><sub>2</sub>, ..., <em>π</em><sub><em>N</em></sub>}</span>：模型在时间
t=1 时处于每个隐藏状态的概率。</p></li>
<li><p>状态转移概率矩阵 <span class="math inline"><em>A</em> = {<em>a</em><sub><em>i</em><em>j</em></sub>}</span>：从隐藏状态
<span class="math inline"><em>s</em><sub><em>i</em></sub></span> 转移到
<span class="math inline"><em>s</em><sub><em>j</em></sub></span>
的概率。</p></li>
<li><p>发射概率矩阵 <span class="math inline"><em>B</em> = {<em>b</em><sub><em>j</em></sub>(<em>k</em>)}</span>：在隐藏状态
<span class="math inline"><em>s</em><sub><em>j</em></sub></span>
下观察到观测 <span class="math inline"><em>o</em><sub><em>k</em></sub></span>
的概率。</p></li>
</ul>
<p>维特比算法的目标是找到最有可能的隐藏状态序列 <span class="math inline"><em>Q</em> = {<em>q</em><sub>1</sub>, <em>q</em><sub>2</sub>, ..., <em>q</em><sub><em>T</em></sub>}</span>，使得
<span class="math inline"><em>P</em>(<em>Q</em>|<em>O</em>)</span>
的值最大，其中 <span class="math inline"><em>O</em> = {<em>O</em><sub>1</sub>, <em>O</em><sub>2</sub>, ..., <em>O</em><sub><em>T</em></sub>}</span>
是已知的观测序列。</p>
<p>维特比算法分为四个主要步骤：初始化、递归计算、终结和回溯。</p>
<p>步骤一：初始化</p>
<p>在第一个时间步 t=1，我们计算到达每个隐藏状态 <span class="math inline"><em>s</em><sub><em>i</em></sub></span>
的最大概率。这个概率是该状态的初始概率 <span class="math inline"><em>π</em><sub><em>i</em></sub></span>
与在该状态下观测到第一个观测值 <span class="math inline"><em>O</em><sub>1</sub></span> 的发射概率 <span class="math inline"><em>b</em><sub><em>i</em></sub>(<em>O</em><sub>1</sub>)</span>
的乘积。</p>
<p>操作：对于每个隐藏状态 <span class="math inline"><em>s</em><sub><em>i</em></sub></span>，计算维特比变量
<span class="math inline"><em>δ</em><sub>1</sub>(<em>i</em>)</span>:
<span class="math inline"><em>δ</em><sub>1</sub>(<em>i</em>) = <em>π</em><sub><em>i</em></sub> ⋅ <em>b</em><sub><em>i</em></sub>(<em>O</em><sub>1</sub>)</span></p>
<p>这一步是为动态规划的起点做准备。我们计算了所有可能的路径中，在时间
t=1 结束于状态 <span class="math inline"><em>s</em><sub><em>i</em></sub></span>
的最大概率。</p>
<p>步骤二：递归计算</p>
<p>从时间步 t=2 到
T，我们对每个时间步和每个隐藏状态进行迭代计算。对于每个状态 <span class="math inline"><em>s</em><sub><em>j</em></sub></span>，我们需要考虑所有从上一个时间步
t-1 的状态 <span class="math inline"><em>s</em><sub><em>i</em></sub></span> 转移到 <span class="math inline"><em>s</em><sub><em>j</em></sub></span>
的可能性，并选择其中概率最大的路径。</p>
<p>操作：对于每个时间步 t (2≤t≤T) 和每个隐藏状态 <span class="math inline"><em>s</em><sub><em>j</em></sub></span>，计算维特比变量
<span class="math inline"><em>δ</em><sub><em>t</em></sub>(<em>j</em>)</span>
和回溯指针 <span class="math inline"><em>ψ</em><sub><em>t</em></sub>(<em>j</em>)</span>。</p>
<p>数学公式: <span class="math inline"><em>δ</em><sub><em>t</em></sub>(<em>j</em>) = max<sub><em>i</em></sub>[<em>δ</em><sub><em>t</em> − 1</sub>(<em>i</em>) ⋅ <em>a</em><sub><em>i</em><em>j</em></sub>] ⋅ <em>b</em><sub><em>j</em></sub>(<em>O</em><sub><em>t</em></sub>)</span>
<span class="math inline"><em>ψ</em><sub><em>t</em></sub>(<em>j</em>) = arg max<sub><em>i</em></sub>[<em>δ</em><sub><em>t</em> − 1</sub>(<em>i</em>) ⋅ <em>a</em><sub><em>i</em><em>j</em></sub>]</span></p>
<p><span class="math inline"><em>δ</em><sub><em>t</em></sub>(<em>j</em>)</span>
的计算：<span class="math inline">max<sub><em>i</em></sub>[<em>δ</em><sub><em>t</em> − 1</sub>(<em>i</em>) ⋅ <em>a</em><sub><em>i</em><em>j</em></sub>]</span>
寻找了从前一个时间步的任意状态 <span class="math inline"><em>s</em><sub><em>i</em></sub></span> 到达当前状态
<span class="math inline"><em>s</em><sub><em>j</em></sub></span>
的最可能路径。然后将其乘以在当前状态 <span class="math inline"><em>s</em><sub><em>j</em></sub></span> 下观测到
<span class="math inline"><em>O</em><sub><em>t</em></sub></span> 的概率
<span class="math inline"><em>b</em><sub><em>j</em></sub>(<em>O</em><sub><em>t</em></sub>)</span>，得到在时间
t 结束于状态 <span class="math inline"><em>s</em><sub><em>j</em></sub></span>
的整体最大概率。</p>
<p><span class="math inline"><em>ψ</em><sub><em>t</em></sub>(<em>j</em>)</span>
的计算：它记录了在时间 t 达到状态 <span class="math inline"><em>s</em><sub><em>j</em></sub></span>
的最可能路径是从时间 t-1 的哪个状态 <span class="math inline"><em>s</em><sub><em>i</em></sub></span>
转移过来的。这个回溯指针是最终重建路径的关键。</p>
<p>步骤三：终结 在处理完所有时间步后，我们找到最后一个时间步 T
中，概率最大的那个状态，这将是我们的最优路径的终点。</p>
<p>操作：找到在时间 t=T 时，所有维特比变量 <span class="math inline"><em>δ</em><sub><em>T</em></sub>(<em>i</em>)</span>
中的最大值。</p>
<p>数学公式：</p>
<p><span class="math inline"><em>P</em><sup>*</sup> = max<sub><em>i</em></sub>[<em>δ</em><sub><em>T</em></sub>(<em>i</em>)]</span>
<span class="math inline"><em>q</em><sub><em>T</em></sub><sup>*</sup> = arg max<sub><em>i</em></sub>[<em>δ</em><sub><em>T</em></sub>(<em>i</em>)]</span></p>
<p>解释：<span class="math inline"><em>P</em><sup>*</sup></span>
是整个观测序列下，最有可能隐藏状态序列的概率。<span class="math inline"><em>q</em><sub><em>T</em></sub><sup>*</sup></span>
是该最优序列的最后一个状态。</p>
<p>步骤四：回溯</p>
<p>这是重建最优路径的关键步骤。我们从最后一个状态 <span class="math inline"><em>q</em><sub><em>T</em></sub><sup>*</sup></span>
开始，利用之前记录的回溯指针 <span class="math inline"><em>ψ</em><sub><em>t</em></sub>(<em>j</em>)</span>
逆向推导出整个序列。</p>
<p>操作：从 t=T 向 t=1 循环，通过回溯指针确定前一个状态。</p>
<p>数学公式：</p>
<p><span class="math inline"><em>q</em><sub><em>t</em> − 1</sub><sup>*</sup> = <em>ψ</em><sub><em>t</em></sub>(<em>q</em><sub><em>t</em></sub><sup>*</sup>)</span></p>
<p>这一步利用了动态规划的特性。由于我们在每一步都记录了最优的前驱状态，我们只需要从终点倒推，就能唯一地确定一条由局部最优解构成的全局最优路径。</p>
<h4 id="示例分析-1">示例分析</h4>
<p>让我们用一个经典的”天气-心情”例子来演示维特比算法。</p>
<ul>
<li><p>隐藏状态：<span class="math inline"><em>S</em> = {<em>晴</em><em>天</em>, <em>雨</em><em>天</em>}</span></p></li>
<li><p>观测序列：<span class="math inline"><em>O</em> = {<em>开</em><em>心</em>, <em>难</em><em>过</em>, <em>开</em><em>心</em>}</span></p></li>
</ul>
<p>参数：</p>
<ul>
<li><p>初始概率 <span class="math inline"><em>π</em></span>：<span class="math inline"><em>π</em><sub><em>晴</em><em>天</em></sub> = 0.6</span>,
<span class="math inline"><em>π</em><sub><em>雨</em><em>天</em></sub> = 0.4</span></p></li>
<li><p>转移概率 <span class="math inline"><em>A</em></span>：</p>
<ul>
<li><p><span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="21.937ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 9696.1 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"/></g><g data-mml-node="mo" transform="translate(751,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(1140,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">晴</text></g><g data-mml-node="mi" transform="translate(2140,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">天</text></g><g data-mml-node="mo" transform="translate(3417.8,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"/></g><g data-mml-node="mi" transform="translate(4695.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">晴</text></g><g data-mml-node="mi" transform="translate(5695.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">天</text></g><g data-mml-node="mo" transform="translate(6695.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(7362.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mn" transform="translate(8418.1,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"/><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)"/><path data-c="37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z" transform="translate(778,0)"/></g></g></g></svg></mjx-container></span></p></li>
<li><p><span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="21.937ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 9696.1 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"/></g><g data-mml-node="mo" transform="translate(751,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(1140,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">晴</text></g><g data-mml-node="mi" transform="translate(2140,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">天</text></g><g data-mml-node="mo" transform="translate(3417.8,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"/></g><g data-mml-node="mi" transform="translate(4695.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">雨</text></g><g data-mml-node="mi" transform="translate(5695.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">天</text></g><g data-mml-node="mo" transform="translate(6695.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(7362.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mn" transform="translate(8418.1,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"/><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)"/><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" transform="translate(778,0)"/></g></g></g></svg></mjx-container></span></p></li>
<li><p><span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="21.937ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 9696.1 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"/></g><g data-mml-node="mo" transform="translate(751,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(1140,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">雨</text></g><g data-mml-node="mi" transform="translate(2140,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">天</text></g><g data-mml-node="mo" transform="translate(3417.8,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"/></g><g data-mml-node="mi" transform="translate(4695.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">晴</text></g><g data-mml-node="mi" transform="translate(5695.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">天</text></g><g data-mml-node="mo" transform="translate(6695.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(7362.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mn" transform="translate(8418.1,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"/><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)"/><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" transform="translate(778,0)"/></g></g></g></svg></mjx-container></span></p></li>
<li><p><span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="21.937ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 9696.1 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"/></g><g data-mml-node="mo" transform="translate(751,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(1140,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">雨</text></g><g data-mml-node="mi" transform="translate(2140,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">天</text></g><g data-mml-node="mo" transform="translate(3417.8,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"/></g><g data-mml-node="mi" transform="translate(4695.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">雨</text></g><g data-mml-node="mi" transform="translate(5695.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">天</text></g><g data-mml-node="mo" transform="translate(6695.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(7362.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mn" transform="translate(8418.1,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"/><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)"/><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" transform="translate(778,0)"/></g></g></g></svg></mjx-container></span></p></li>
</ul></li>
<li><p>发射概率 <span class="math inline"><em>B</em></span>：</p>
<ul>
<li><p><span class="math inline"><em>P</em>(<em>开</em><em>心</em>|<em>晴</em><em>天</em>) = 0.8</span></p></li>
<li><p><span class="math inline"><em>P</em>(<em>难</em><em>过</em>|<em>晴</em><em>天</em>) = 0.2</span></p></li>
<li><p><span class="math inline"><em>P</em>(<em>开</em><em>心</em>|<em>雨</em><em>天</em>) = 0.3</span></p></li>
<li><p><span class="math inline"><em>P</em>(<em>难</em><em>过</em>|<em>雨</em><em>天</em>) = 0.7</span></p></li>
</ul></li>
</ul>
<p>计算过程如下：</p>
<ol type="1">
<li>时间步 <span class="math inline"><em>t</em> = 1</span> (观测：开心):
初始概率乘发射概率来实现初始化</li>
</ol>
<p><span class="math inline"><em>δ</em><sub>1</sub>(<em>晴</em><em>天</em>) = <em>π</em><sub><em>晴</em><em>天</em></sub> ⋅ <em>b</em><sub><em>晴</em><em>天</em></sub>(<em>开</em><em>心</em>) = 0.6 ⋅ 0.8 = 0.48</span></p>
<p><span class="math inline"><em>δ</em><sub>1</sub>(<em>雨</em><em>天</em>) = <em>π</em><sub><em>雨</em><em>天</em></sub> ⋅ <em>b</em><sub><em>雨</em><em>天</em></sub>(<em>开</em><em>心</em>) = 0.4 ⋅ 0.3 = 0.12</span></p>
<p>这样,
我们计算了第一天是晴天（概率0.48）和雨天（概率0.12）的各自最大概率路径。</p>
<ol start="2" type="1">
<li>时间步 <span class="math inline"><em>t</em> = 2</span> (观测：难过):
计算 <span class="math inline"><em>δ</em><sub>2</sub></span> 和 <span class="math inline"><em>ψ</em><sub>2</sub></span></li>
</ol>
<p><span class="math inline"><em>δ</em><sub>2</sub>(<em>晴</em><em>天</em>) = max [<em>δ</em><sub>1</sub>(<em>晴</em><em>天</em>) ⋅ <em>a</em><sub><em>晴</em><em>天</em>, <em>晴</em><em>天</em></sub>, <em>δ</em><sub>1</sub>(<em>雨</em><em>天</em>) ⋅ <em>a</em><sub><em>雨</em><em>天</em>, <em>晴</em><em>天</em></sub>] ⋅ <em>b</em><sub><em>晴</em><em>天</em></sub>(<em>难</em><em>过</em>)</span></p>
<p><span class="math inline"> = max [0.48 ⋅ 0.7, 0.12 ⋅ 0.4] ⋅ 0.2 = max [0.336, 0.048] ⋅ 0.2 = 0.336 ⋅ 0.2 = 0.0672</span></p>
<p><span class="math inline"><em>ψ</em><sub>2</sub>(<em>晴</em><em>天</em>) = <em>晴</em><em>天</em></span>
（因为 <span class="math inline">0.336 &gt; 0.048</span>）</p>
<p><span class="math inline"><em>δ</em><sub>2</sub>(<em>雨</em><em>天</em>) = max [<em>δ</em><sub>1</sub>(<em>晴</em><em>天</em>) ⋅ <em>a</em><sub><em>晴</em><em>天</em>, <em>雨</em><em>天</em></sub>, <em>δ</em><sub>1</sub>(<em>雨</em><em>天</em>) ⋅ <em>a</em><sub><em>雨</em><em>天</em>, <em>雨</em><em>天</em></sub>] ⋅ <em>b</em><sub><em>雨</em><em>天</em></sub>(<em>难</em><em>过</em>)</span></p>
<p><span class="math inline"> = max [0.48 ⋅ 0.3, 0.12 ⋅ 0.6] ⋅ 0.7 = max [0.144, 0.072] ⋅ 0.7 = 0.144 ⋅ 0.7 = 0.1008</span></p>
<p><span class="math inline"><em>ψ</em><sub>2</sub>(<em>雨</em><em>天</em>) = <em>晴</em><em>天</em></span>
（因为 <span class="math inline">0.144 &gt; 0.072</span>）</p>
<p>在第二天，我们分别计算了结束于”晴天”和”雨天”的两种可能路径的最大概率。我们发现，要到达”晴天”状态，最可能的前一天状态是”晴天”；要到达”雨天”状态，最可能的前一天状态也是”晴天”。</p>
<ol start="3" type="1">
<li>时间步 <span class="math inline"><em>t</em> = 3</span> (观测：开心):
计算 <span class="math inline"><em>δ</em><sub>3</sub></span> 和 <span class="math inline"><em>ψ</em><sub>3</sub></span></li>
</ol>
<p><span class="math inline"><em>δ</em><sub>3</sub>(<em>晴</em><em>天</em>) = max [<em>δ</em><sub>2</sub>(<em>晴</em><em>天</em>) ⋅ <em>a</em><sub><em>晴</em><em>天</em>, <em>晴</em><em>天</em></sub>, <em>δ</em><sub>2</sub>(<em>雨</em><em>天</em>) ⋅ <em>a</em><sub><em>雨</em><em>天</em>, <em>晴</em><em>天</em></sub>] ⋅ <em>b</em><sub><em>晴</em><em>天</em></sub>(<em>开</em><em>心</em>)</span></p>
<p><span class="math inline"> = max [0.0672 ⋅ 0.7, 0.1008 ⋅ 0.4] ⋅ 0.8 = max [0.04704, 0.04032] ⋅ 0.8 = 0.04704 ⋅ 0.8 = 0.037632</span></p>
<p><span class="math inline"><em>ψ</em><sub>3</sub>(<em>晴</em><em>天</em>) = <em>晴</em><em>天</em></span></p>
<p><span class="math inline"><em>δ</em><sub>3</sub>(<em>雨</em><em>天</em>) = max [<em>δ</em><sub>2</sub>(<em>晴</em><em>天</em>) ⋅ <em>a</em><sub><em>晴</em><em>天</em>, <em>雨</em><em>天</em></sub>, <em>δ</em><sub>2</sub>(<em>雨</em><em>天</em>) ⋅ <em>a</em><sub><em>雨</em><em>天</em>, <em>雨</em><em>天</em></sub>] ⋅ <em>b</em><sub><em>雨</em><em>天</em></sub>(<em>开</em><em>心</em>)</span></p>
<p><span class="math inline"> = max [0.0672 ⋅ 0.3, 0.1008 ⋅ 0.6] ⋅ 0.3 = max [0.02016, 0.06048] ⋅ 0.3 = 0.06048 ⋅ 0.3 = 0.018144</span></p>
<p><span class="math inline"><em>ψ</em><sub>3</sub>(<em>雨</em><em>天</em>) = <em>雨</em><em>天</em></span></p>
<ol start="4" type="1">
<li>终结和回溯</li>
</ol>
<p>比较 <span class="math inline"><em>δ</em><sub>3</sub>(<em>晴</em><em>天</em>)</span>
和 <span class="math inline"><em>δ</em><sub>3</sub>(<em>雨</em><em>天</em>)</span>,
有<span class="math inline">0.037632 &gt; 0.018144</span></p>
<p>因此，最优路径的最后一个状态是 晴天。</p>
<p>最后我们回溯路径即可得到结果：</p>
<p><span class="math inline"><em>q</em><sub>3</sub><sup>*</sup> = <em>晴</em><em>天</em></span></p>
<p><span class="math inline"><em>q</em><sub>2</sub><sup>*</sup> = <em>ψ</em><sub>3</sub>(<em>q</em><sub>3</sub><sup>*</sup>) = <em>ψ</em><sub>3</sub>(<em>晴</em><em>天</em>) = <em>晴</em><em>天</em></span></p>
<p><span class="math inline"><em>q</em><sub>1</sub><sup>*</sup> = <em>ψ</em><sub>2</sub>(<em>q</em><sub>2</sub><sup>*</sup>) = <em>ψ</em><sub>2</sub>(<em>晴</em><em>天</em>) = <em>晴</em><em>天</em></span></p>
<p>因此, 最有可能的隐藏状态序列是：{晴天, 晴天, 晴天}。</p>
<h4 id="应用领域">应用领域</h4>
<p>维特比算法因其高效和准确性，在许多领域有广泛应用，例如：</p>
<ul>
<li><p>语音识别：根据声学模型（隐藏状态）和声音信号（观测）找到最可能的单词序列。</p></li>
<li><p>自然语言处理：</p>
<ul>
<li>用于词性标注（Part-of-Speech
Tagging），根据单词序列（观测）找到最可能的词性序列（隐藏状态）。</li>
<li>用于命名实体识别（Named Entity
Recognition），根据文本序列（观测）找到最可能的实体序列（隐藏状态）。</li>
</ul></li>
<li><p>生物信息学：用于基因识别，根据 DNA
序列（观测）找到编码区和非编码区（隐藏状态）。</p></li>
<li><p>无线通信：在编码理论中用于信道解码。</p></li>
</ul>

		</div>

		

		
		<ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
			
			<li class="tag-item mx-0.5">
				<a href="/tags/AI/">#AI</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/CS188/">#CS188</a>&nbsp;
			</li>
			
		</ul>
		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/2025/08/26/ai/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BDAI/CS188/16/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item truncate max-w-48">Particle Filtering, Utility Theory(16)</span>
						<span class="post-nav-item">Prev posts</span>
					</span>
				</a>
			</div>
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/2025/08/25/ai/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BDAI/CS188/14/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item truncate max-w-48">HMMs -- Markov Chains, HMMs(14)</span>
						<span class="post-nav-item">Next posts</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">On this page</div>
		<div class="page-title">HMMs (Forward Algorithm, Viterbi Algorithm)(15)</div>
		<ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B-hidden-markov-models"><span class="nav-text">隐马尔可夫模型 (Hidden
Markov Models)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E5%90%91%E7%AE%97%E6%B3%95"><span class="nav-text">前向算法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%E6%97%B6%E9%97%B4%E6%B5%81%E9%80%9D%E6%9B%B4%E6%96%B0-time-elapse-update"><span class="nav-text">第一步：时间流逝更新
(Time Elapse Update)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%E8%A7%82%E6%B5%8B%E6%9B%B4%E6%96%B0-observation-update"><span class="nav-text">第二步：观测更新 (Observation
Update)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E5%90%91%E7%AE%97%E6%B3%95%E7%9A%84%E6%A0%B8%E5%BF%83"><span class="nav-text">前向算法的核心</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%E5%88%86%E6%9E%90"><span class="nav-text">示例分析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%B4%E7%89%B9%E6%AF%94%E7%AE%97%E6%B3%95viterbi-algorithm"><span class="nav-text">维特比算法（Viterbi
Algorithm）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%AD%A5%E9%AA%A4"><span class="nav-text">基本步骤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%E5%88%86%E6%9E%90-1"><span class="nav-text">示例分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F"><span class="nav-text">应用领域</span></a></li></ol></li></ol></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
            <div class="customize-info my-1">AI是新时代的灯塔</div>
        
        <div class="text-center">
            &copy;
            
              <span>2025</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">ZaynPei</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        186 posts in total
                    </span>
                    
                        <span>
                            578.6k words in total
                        </span>
                    
                </p>
            
        </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.5</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
            
                
        
                
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="arrow-up fas fa-arrow-up"></i>
			<span class="percent"></span>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	
	<div class="search-pop-overlay">
	<div class="popup search-popup">
		<div class="search-header">
			<span class="search-input-field-pre">
				<i class="fa-solid fa-keyboard"></i>
			</span>
			<div class="search-input-container">
				<input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input">
			</div>
			<span class="popup-btn-close">
				<i class="fa-solid fa-times"></i>
			</span>
		</div>
		<div id="search-result">
			<div id="no-result">
				<i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
			</div>
		</div>
	</div>
</div>
	

</main>



<script src="/js/build/libs/Swup.min.js"></script>

<script src="/js/build/libs/SwupSlideTheme.min.js"></script>

<script src="/js/build/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/build/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/build/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/build/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	
<script src="/js/build/tools/imageViewer.js" type="module"></script>

<script src="/js/build/utils.js" type="module"></script>

<script src="/js/build/main.js" type="module"></script>

<script src="/js/build/layouts/navbarShrink.js" type="module"></script>

<script src="/js/build/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/build/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/build/layouts/categoryList.js" type="module"></script>



    
<script src="/js/build/tools/localSearch.js" type="module"></script>




    
<script src="/js/build/tools/codeBlock.js" type="module"></script>




    
<script src="/js/build/layouts/lazyload.js" type="module"></script>




    
<script src="/js/build/tools/runtime.js"></script>

    
<script src="/js/build/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/build/libs/Typed.min.js"></script>

  
<script src="/js/build/plugins/typed.js" type="module"></script>








    
<script src="/js/build/libs/anime.min.js"></script>





    
<script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script>





	
</body>

</html>