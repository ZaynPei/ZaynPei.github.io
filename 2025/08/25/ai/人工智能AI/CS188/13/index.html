<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="ZaynPei">
    
    <!-- Completely eliminate flash of wrong theme -->
    <script>
        (function() {
            const THEME_KEY = "REDEFINE-THEME-STATUS";
            const DARK = "dark", LIGHT = "light";
            
            // Get preferred theme
            function getTheme() {
                try {
                    const saved = localStorage.getItem(THEME_KEY);
                    if (saved) {
                        const { isDark } = JSON.parse(saved);
                        return isDark ? DARK : LIGHT;
                    }
                } catch (e) {}
                
                return matchMedia("(prefers-color-scheme: dark)").matches ? DARK : LIGHT;
            }
            
            // Apply theme to document
            function applyTheme(theme) {
                const isDark = theme === DARK;
                const root = document.documentElement;
                
                // Set data attribute for CSS variables
                root.setAttribute("data-theme", theme);
                
                // Set classes for compatibility
                root.classList.add(theme);
                root.classList.remove(isDark ? LIGHT : DARK);
                root.style.colorScheme = theme;
            }
            
            // Initial application
            const theme = getTheme();
            applyTheme(theme);
            
            // Listen for system preference changes
            matchMedia("(prefers-color-scheme: dark)").addEventListener("change", ({ matches }) => {
                // Only update if using system preference (no localStorage entry)
                if (!localStorage.getItem(THEME_KEY)) {
                    applyTheme(matches ? DARK : LIGHT);
                }
            });
            
            // Set body classes once DOM is ready
            if (document.readyState !== "loading") {
                document.body.classList.add(theme + "-mode");
            } else {
                document.addEventListener("DOMContentLoaded", () => {
                    document.body.classList.add(theme + "-mode");
                    document.body.classList.remove((theme === DARK ? LIGHT : DARK) + "-mode");
                });
            }
        })();
    </script>
    
    <!-- Critical CSS to prevent flash -->
    <style>
        :root[data-theme="dark"] {
            --background-color: #202124;
            --background-color-transparent: rgba(32, 33, 36, 0.6);
            --second-background-color: #2d2e32;
            --third-background-color: #34353a;
            --third-background-color-transparent: rgba(32, 33, 36, 0.6);
            --primary-color: #0066CC;
            --first-text-color: #ffffff;
            --second-text-color: #eeeeee;
            --third-text-color: #bebec6;
            --fourth-text-color: #999999;
            --default-text-color: #bebec6;
            --invert-text-color: #373D3F;
            --border-color: rgba(255, 255, 255, 0.08);
            --selection-color: #0066CC;
            --shadow-color-1: rgba(255, 255, 255, 0.08);
            --shadow-color-2: rgba(255, 255, 255, 0.05);
        }
        
        :root[data-theme="light"] {
            --background-color: #fff;
            --background-color-transparent: rgba(255, 255, 255, 0.6);
            --second-background-color: #f8f8f8;
            --third-background-color: #f2f2f2;
            --third-background-color-transparent: rgba(241, 241, 241, 0.6);
            --primary-color: #0066CC;
            --first-text-color: #16171a;
            --second-text-color: #2f3037;
            --third-text-color: #5e5e5e;
            --fourth-text-color: #eeeeee;
            --default-text-color: #373D3F;
            --invert-text-color: #bebec6;
            --border-color: rgba(0, 0, 0, 0.08);
            --selection-color: #0066CC;
            --shadow-color-1: rgba(0, 0, 0, 0.08);
            --shadow-color-2: rgba(0, 0, 0, 0.05);
        }
        
        body {
            background-color: var(--background-color);
            color: var(--default-text-color);
        }
        
        /* Apply body classes as soon as DOM is ready */
        :root[data-theme="dark"] body {
            background-color: var(--background-color);
            color: var(--default-text-color);
        }
    </style>
    
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://zaynpei.github.io/2025/08/25/ai/人工智能ai/cs188/13/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:type" content="article">
<meta property="og:title" content="Bayes Nets -- Sampling(13)">
<meta property="og:url" content="https://zaynpei.github.io/2025/08/25/ai/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BDAI/CS188/13/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://zaynpei.github.io/images/redefine-og.webp">
<meta property="article:published_time" content="2025-08-25T07:00:00.000Z">
<meta property="article:modified_time" content="2025-08-27T06:57:08.147Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="AI">
<meta property="article:tag" content="CS188">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zaynpei.github.io/images/redefine-og.webp">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/icons%E7%81%AF%E5%A1%94.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/icons%E7%81%AF%E5%A1%94.png">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/icons%E7%81%AF%E5%A1%94.png">
    <!--- Page Info-->
    
    <title>
        
            Bayes Nets -- Sampling(13) | ZaynPei&#39;s Base
        
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    
        
            
    
            
    
            
                
                    <link rel="stylesheet" href="/css/custom.css">
                
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/css/build/tailwind.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
        <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    
        <link href="https://cdn.jsdelivr.net/npm/@callmebill/lxgw-wenkai-web@1.320/style.css" rel="stylesheet">
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"zaynpei.github.io","root":"/","language":"en","path":"search.json"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"default","dark":"a11y-dark"},"font":{"enable":true,"family":"'JetBrains Mono', monospace","url":"https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap"}},"toc":{"enable":true,"max_depth":6,"number":false,"expand":true,"init_open":true},"copyright":{"enable":false,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":false,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]},"font":{"enable":true,"url":"https://cdn.jsdelivr.net/npm/@callmebill/lxgw-wenkai-web@1.320/style.css","family":"'LXGW WenKai', sans-serif"}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":true,"family":"'LXGW WenKai', sans-serif","url":"https://cdn.jsdelivr.net/npm/@callmebill/lxgw-wenkai-web@1.320/style.css"},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":false,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"side_tools":{"gear_rotation":true,"auto_expand":false},"open_graph":{"enable":true,"image":"/images/redefine-og.webp","description":"Hexo Theme Redefine, Redefine Your Hexo Journey."},"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"For ourselves","subtitle":{"text":["For yourself"],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"style":"default","links":{"github":null,"instagram":null,"zhihu":null,"twitter":null,"email":null},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.8.5","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"ai":{"path":"docs/ai/","icon":"fa-regular fa-robot"},"algorithms":{"path":"docs/algorithms/","icon":"fa-regular fa-code"},"language":{"path":"docs/lang/","icon":"fa-regular fa-language"},"system":{"path":"docs/system/","icon":"fa-regular fa-desktop"},"web":{"path":"docs/web/","icon":"fa-regular fa-globe"},"misc":{"path":"docs/misc/","icon":"fa-regular fa-boxes-stacked"},"tools":{"path":"docs/tools/","icon":"fa-regular fa-wrench"}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":null},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2025/6/25 13:20:00"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>



<body>
	<div class="progress-bar-container">
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
                <a class="logo-image h-8 w-8 sm:w-10 sm:h-10 mr-3" href="/">
                    <img src="/images/icons%E7%81%AF%E5%A1%94.png" class="w-full h-full rounded-xs">
                </a>
            
            <a class="logo-title" href="/">
                
                ZaynPei&#39;s Base
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    HOME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/docs/ai/"
                                        >
                                    <i class="fa-regular fa-robot fa-fw"></i>
                                    AI
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/docs/algorithms/"
                                        >
                                    <i class="fa-regular fa-code fa-fw"></i>
                                    ALGORITHMS
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/docs/lang/"
                                        >
                                    <i class="fa-regular fa-language fa-fw"></i>
                                    LANGUAGE
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/docs/system/"
                                        >
                                    <i class="fa-regular fa-desktop fa-fw"></i>
                                    SYSTEM
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/docs/web/"
                                        >
                                    <i class="fa-regular fa-globe fa-fw"></i>
                                    WEB
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/docs/misc/"
                                        >
                                    <i class="fa-regular fa-boxes-stacked fa-fw"></i>
                                    MISC
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/docs/tools/"
                                        >
                                    <i class="fa-regular fa-wrench fa-fw"></i>
                                    TOOLS
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                HOME
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/docs/ai/"
                        >
                            <span>
                                AI
                            </span>
                            
                                <i class="fa-regular fa-robot fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/docs/algorithms/"
                        >
                            <span>
                                ALGORITHMS
                            </span>
                            
                                <i class="fa-regular fa-code fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/docs/lang/"
                        >
                            <span>
                                LANGUAGE
                            </span>
                            
                                <i class="fa-regular fa-language fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/docs/system/"
                        >
                            <span>
                                SYSTEM
                            </span>
                            
                                <i class="fa-regular fa-desktop fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/docs/web/"
                        >
                            <span>
                                WEB
                            </span>
                            
                                <i class="fa-regular fa-globe fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/docs/misc/"
                        >
                            <span>
                                MISC
                            </span>
                            
                                <i class="fa-regular fa-boxes-stacked fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/docs/tools/"
                        >
                            <span>
                                TOOLS
                            </span>
                            
                                <i class="fa-regular fa-wrench fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            

            
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">19</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">21</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">186</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">Bayes Nets -- Sampling(13)</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="/images/redefine-avatar.svg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">ZaynPei</span>
					
					<span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv6</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-08-25 15:00</span>
        <span class="mobile">2025-08-25 15:00</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-08-27 14:57:08</span>
            <span class="mobile">2025-08-27 14:57:08</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/AI/">AI</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/AI/">AI</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/CS188/">CS188</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-typewriter"></i>&nbsp;<span>4.8k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fa-regular fa-clock"></i>&nbsp;<span>18 Mins</span>
        </span>
    
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<p>上一讲我们学习了变量消除等算法，它们能精确地计算出概率查询的结果。但我们也知道，精确推理在最坏情况下是NP难的，对于非常庞大和复杂的贝叶斯网络，精确计算仍然是不可行的。</p>
<p>这一讲的核心思想是：当我们无法承担精确计算的巨大代价时，我们可以退而求其次，通过生成大量随机样本来“近似”地估算概率。这种方法被称为近似推理
(Approximate Inference)，而采样 (Sampling) 是实现它的核心技术。</p>
<h2 id="先验采样-prior-sampling和拒绝采样-rejection-sampling">先验采样
(Prior Sampling)和拒绝采样 (Rejection Sampling)</h2>
<p>先验采样是最基础、最简单的采样方法,
它直接模拟贝叶斯网络的生成过程来创建一个完整的样本。</p>
<p>算法流程为:</p>
<ul>
<li><p>按照贝叶斯网络的拓扑顺序（从父节点到子节点）遍历所有变量。</p></li>
<li><p>对于每个变量 X，根据其条件概率表 <span class="math inline"><em>P</em>(<em>X</em>|Parents(<em>X</em>))</span>（此时其所有父节点的值都已被采样确定），随机采样一个值赋给
X。</p></li>
<li><p>重复此过程，直到所有变量都被赋值，就得到了一个完整的样本。</p></li>
</ul>
<p>显而易见,
这种方法非常低效，尤其是在处理带证据的查询时。如果我们想计算 <span class="math inline"><em>P</em>(<em>C</em>|−<em>t</em>)</span>，而 $P(-t)
的概率只有1%。那么，先验采样生成的样本中，大约有99%的样本都会因为 T=+t
而与证据不符，这些样本最终都会被丢弃。为了得到足够多的有效样本，我们需要生成海量的总样本，造成巨大的计算浪费。</p>
<p>而拒绝采样就是对先验采样的一个简单优化。它在生成样本的过程中，一旦发现某个变量的采样值与证据不符，就立刻停止并拒绝这个样本，然后重新开始一个新的。</p>
<p>它避免了为那些注定要被丢弃的样本浪费后续的计算时间。然而,
虽然有所改进，但它仍然没有解决根本问题。在证据本身是小概率事件的情况下，绝大多数的采样尝试仍然会在早期就被拒绝，效率依然很低。</p>
<h2 id="似然加权-likelihood-weighting">似然加权 (Likelihood
Weighting)</h2>
<p>这是本次讲义介绍的第一个真正实用的采样算法，它保证了生成的每一个样本都与证据相符。</p>
<p>核心思想：我们不再随机地生成所有变量的值，而是强制将所有<strong>证据变量的值固定为观测到的值</strong>。但是，这种“强行设定”会扭曲样本的原始概率分布。为了修正这个偏差，我们为每个样本引入一个权重
(weight)。</p>
<blockquote>
<p>证据变量指的是值固定的变量, 例如<span class="math inline"><em>P</em>(<em>S</em> ∣ <em>C</em>)</span>中的C;
非证据变量是需要被采样的变量, 例如上述概率公式中的S。</p>
</blockquote>
<p>算法流程（以计算 <span class="math inline"><em>P</em>(<em>T</em>|+<em>c</em>, +<em>e</em>)</span>
为例）：</p>
<ol type="1">
<li><p>初始化：将样本权重 w 设为 1.0。将证据变量 C 和 E 的值固定为 +c 和
+e。</p></li>
<li><p>遍历变量（按拓扑序）：</p>
<ul>
<li><p>对于非证据变量（如 T 和
S）：像先验采样一样，根据其父节点的值进行随机采样。</p></li>
<li><p>对于证据变量（如 C 和 E）：不进行采样。而是，将当前样本的权重 w
乘以该证据变量在其父节点取相应值时的条件概率。</p></li>
<li><p>例如，当处理到 C 时，我们将权重更新为 w = w * P(+c | tⱼ)，其中 tⱼ
是 T 在当前样本中的采样值。这个乘法操作的含义是：“在给定父节点 tⱼ
的情况下，我们观测到 +c
这个证据的可能性有多大？”这个可能性就被作为权重的一部分。</p></li>
</ul></li>
<li><p>最终计算：在收集了足够多的带权样本后，我们不再是简单地计数，而是计算加权计数。例如，要计算
<span class="math inline"><em>P</em>(+<em>t</em>|+<em>c</em>, +<em>e</em>)</span>，我们将所有
T=+t 的样本的权重相加，然后除以所有样本的总权重。</p></li>
</ol>
<h3 id="原理推导">原理推导</h3>
<p>首先我们给出结论，似然加权方法之所以具有一致性，是因为它通过为样本分配权重，巧妙地使<strong>加权后的采样分布</strong>等同于<strong>真实的全联合概率分布</strong>。这意味着，通过对这些加权样本进行求和或计算平均值，我们能够得到对真实概率分布的无偏估计。</p>
<ol type="1">
<li><strong>采样分布 <span class="math inline"><em>S</em><sub><em>W</em><em>S</em></sub>(<em>z</em>, <em>e</em>)</span></strong></li>
</ol>
<p>这个公式描述了似然加权算法生成一个特定样本的概率：</p>
<p><span class="math display"><em>S</em><sub><em>W</em><em>S</em></sub>(<em>z</em>, <em>e</em>) = ∏<sub><em>j</em></sub><em>P</em>(<em>z</em><sub><em>j</em></sub>|<em>p</em><em>a</em><em>r</em><em>e</em><em>n</em><em>t</em><em>s</em>(<em>Z</em><sub><em>j</em></sub>))</span></p>
<p>其中： - z：需要采样的变量集合 - e：固定的证据变量集合 -
显然，这两组变量的并集就是网络中的所有变量。</p>
<p>解释：在似然加权中，我们只对非证据变量进行采样。这个公式是所有被采样变量(<span class="math inline"><em>z</em><sub><em>j</em></sub></span>)的条件概率乘积。例如，如果W是证据变量，那么C,S,R是被采样的变量。这个采样的分布就是<span class="math inline"><em>P</em>(<em>C</em>) ⋅ <em>P</em>(<em>S</em>|<em>C</em>) ⋅ <em>P</em>(<em>R</em>|<em>C</em>)</span>。</p>
<ol start="2" type="1">
<li><strong>样本权重 <span class="math inline"><em>w</em>(<em>z</em>, <em>e</em>)</span></strong></li>
</ol>
<p>这个公式定义了每个生成样本的权重：</p>
<p><span class="math display"><em>w</em>(<em>z</em>, <em>e</em>) = ∏<sub><em>k</em></sub><em>P</em>(<em>e</em><sub><em>k</em></sub>|<em>p</em><em>a</em><em>r</em><em>e</em><em>n</em><em>t</em><em>s</em>(<em>E</em><sub><em>k</em></sub>))</span></p>
<p>解释：这个权重是所有证据变量(<span class="math inline"><em>e</em><sub><em>k</em></sub></span>)的条件概率的乘积，每个证据变量的条件概率是基于其在当前样本中的父节点值。这个权重衡量了当前生成的样本与已知证据的一致程度。</p>
<ol start="3" type="1">
<li><strong>联合分布的一致性证明</strong></li>
</ol>
<p>这是证明似然加权正确性的核心：</p>
<p><span class="math display"><em>S</em><sub><em>W</em><em>S</em></sub>(<em>z</em>, <em>e</em>) ⋅ <em>w</em>(<em>z</em>, <em>e</em>) = (∏<sub><em>j</em></sub><em>P</em>(<em>z</em><sub><em>j</em></sub>|<em>p</em><em>a</em><em>r</em><em>e</em><em>n</em><em>t</em><em>s</em>(<em>Z</em><sub><em>j</em></sub>)))(∏<sub><em>k</em></sub><em>P</em>(<em>e</em><sub><em>k</em></sub>|<em>p</em><em>a</em><em>r</em><em>e</em><em>n</em><em>t</em><em>s</em>(<em>E</em><sub><em>k</em></sub>)))</span></p>
<p>解释：当我们将采样分布和样本权重相乘时，我们得到的是所有变量（包括被采样的<span class="math inline"><em>z</em><sub><em>j</em></sub></span>和证据<span class="math inline"><em>e</em><sub><em>k</em></sub></span>）的条件概率乘积。这正是贝叶斯网络中全联合概率分布的定义：</p>
<p><span class="math display"><em>P</em>(<em>z</em>, <em>e</em>) = ∏<sub><em>i</em></sub><em>P</em>(<em>X</em><sub><em>i</em></sub>|<em>p</em><em>a</em><em>r</em><em>e</em><em>n</em><em>t</em><em>s</em>(<em>X</em><sub><em>i</em></sub>))</span></p>
<p>当这两部分的结果相乘时，它们精确地、完整地重建了原始的全联合概率分布。这就是为什么加权后的采样分布能够无偏地代表真实的联合概率分布，从而保证了算法的一致性。因此，我们可以得出结论：</p>
<p><span class="math display"><em>S</em><sub><em>W</em><em>S</em></sub>(<em>z</em>, <em>e</em>) ⋅ <em>w</em>(<em>z</em>, <em>e</em>) = <em>P</em>(<em>z</em>, <em>e</em>)</span></p>
<h3 id="示例分析">示例分析</h3>
<ul>
<li><p><strong>网络结构</strong>：C→S, C→R, S→W, R→W</p></li>
<li><p><strong>查询目标</strong>：计算
P(C=T∣S=T,W=T)，即在洒水器打开(S=True)且草地湿润(W=True)的情况下，多云(C=True)的概率</p></li>
<li><p><strong>证据变量</strong>：e={S=T,W=T}</p></li>
<li><p><strong>非证据变量</strong>：Z={C,R}</p></li>
</ul>
<p>条件概率表如下:</p>
<p><strong>P(C):</strong> | C | P(C) | |:—–:|:——-:| | T | 0.5 |</p>
<p><strong>P(S∣C):</strong> | C | P(S=T∣C) | |:—–:|:——-:| | T | 0.1 | |
F | 0.5 |</p>
<p><strong>P(R∣C):</strong> | C | P(R=T∣C) | |:—–:|:——-:| | T | 0.8 | |
F | 0.2 |</p>
<p><strong>P(W∣S,R):</strong> | S | R | P(W=T∣S,R) | |:—:|:—:|:————-:| |
T | T | 0.99 | | T | F | 0.9 |</p>
<p>下面展示似然加权生成一个样本的全过程:</p>
<ol type="1">
<li>初始化</li>
</ol>
<ul>
<li>证据：S=T,W=T</li>
<li>样本权重：w=1.0</li>
</ul>
<ol start="2" type="1">
<li>处理变量 C</li>
</ol>
<ul>
<li>C是非证据变量，需采样</li>
<li>根据P(C)采样，结果：C=F</li>
<li>当前样本：{C=F}，w=1.0</li>
</ul>
<ol start="3" type="1">
<li>处理变量 S</li>
</ol>
<ul>
<li>S为证据变量(S=T)</li>
<li>更新权重：w = w × P(S=T∣C=F) = 1.0 × 0.5 = 0.5</li>
<li>当前样本：{C=F}，w=0.5</li>
</ul>
<ol start="4" type="1">
<li>处理变量 R</li>
</ol>
<ul>
<li>R是非证据变量，需采样</li>
<li>根据P(R∣C=F)采样，结果：R=T</li>
<li>当前样本：{C=F,R=T}，w=0.5</li>
</ul>
<ol start="5" type="1">
<li>处理变量 W</li>
</ol>
<ul>
<li>W为证据变量(W=T)</li>
<li>更新权重：w = w × P(W=T∣S=T,R=T) = 0.5 × 0.99 = 0.495</li>
<li>最终样本：{C=F,R=T}，w=0.495</li>
</ul>
<p>下面验证”加权采样分布 = 真实联合概率”：</p>
<ol type="1">
<li>采样概率SWS(z,e)：
<ul>
<li>SWS = P(C=F) × P(R=T∣C=F) = (1-0.5) × 0.2 = 0.1</li>
</ul></li>
<li>样本权重w(z,e)：
<ul>
<li>w = P(S=T∣C=F) × P(W=T∣S=T,R=T) = 0.5 × 0.99 = 0.495</li>
</ul></li>
<li>两者相乘：
<ul>
<li>SWS × w = 0.1 × 0.495 = 0.0495</li>
</ul></li>
<li>真实联合概率P(z,e)：
<ul>
<li>P(C=F,S=T,R=T,W=T) = P(C=F) × P(S=T∣C=F) × P(R=T∣C=F) ×
P(W=T∣S=T,R=T)</li>
<li>= 0.5 × 0.5 × 0.2 × 0.99 = 0.0495</li>
</ul></li>
</ol>
<p>可以看出验证的结果是两者完全相等.</p>
<p>重复上述过程多次后，使用以下公式计算：</p>
<p>P(C=T∣S=T,W=T) ≈ <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -1.158ex;" xmlns="http://www.w3.org/2000/svg" width="20.548ex" height="3.447ex" role="img" focusable="false" viewbox="0 -1011.8 9082.3 1523.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mtext" transform="translate(220,481.4) scale(0.707)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">所</text><text data-variant="normal" transform="translate(1000,0) scale(1,-1)" font-size="884px" font-family="serif">有</text><path data-c="43" d="M56 342Q56 428 89 500T174 615T283 681T391 705Q394 705 400 705T408 704Q499 704 569 636L582 624L612 663Q639 700 643 704Q644 704 647 704T653 705H657Q660 705 666 699V419L660 413H626Q620 419 619 430Q610 512 571 572T476 651Q457 658 426 658Q322 658 252 588Q173 509 173 342Q173 221 211 151Q232 111 263 84T328 45T384 29T428 24Q517 24 571 93T626 244Q626 251 632 257H660L666 251V236Q661 133 590 56T403 -21Q262 -21 159 83T56 342Z" transform="translate(2000,0)"/><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" transform="translate(2722,0)"/><path data-c="54" d="M36 443Q37 448 46 558T55 671V677H666V671Q667 666 676 556T685 443V437H645V443Q645 445 642 478T631 544T610 593Q593 614 555 625Q534 630 478 630H451H443Q417 630 414 618Q413 616 413 339V63Q420 53 439 50T528 46H558V0H545L361 3Q186 1 177 0H164V46H194Q264 46 283 49T309 63V339V550Q309 620 304 625T271 630H244H224Q154 630 119 601Q101 585 93 554T81 486T76 443V437H36V443Z" transform="translate(3500,0)"/><text data-variant="normal" transform="translate(4222,0) scale(1,-1)" font-size="884px" font-family="serif">的</text><text data-variant="normal" transform="translate(5222,0) scale(1,-1)" font-size="884px" font-family="serif">样</text><text data-variant="normal" transform="translate(6222,0) scale(1,-1)" font-size="884px" font-family="serif">本</text><text data-variant="normal" transform="translate(7222,0) scale(1,-1)" font-size="884px" font-family="serif">的</text><text data-variant="normal" transform="translate(8222,0) scale(1,-1)" font-size="884px" font-family="serif">权</text><text data-variant="normal" transform="translate(9222,0) scale(1,-1)" font-size="884px" font-family="serif">重</text><text data-variant="normal" transform="translate(10222,0) scale(1,-1)" font-size="884px" font-family="serif">之</text><text data-variant="normal" transform="translate(11222,0) scale(1,-1)" font-size="884px" font-family="serif">和</text></g><g data-mml-node="mtext" transform="translate(1359.1,-370.3) scale(0.707)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">所</text><text data-variant="normal" transform="translate(1000,0) scale(1,-1)" font-size="884px" font-family="serif">有</text><text data-variant="normal" transform="translate(2000,0) scale(1,-1)" font-size="884px" font-family="serif">样</text><text data-variant="normal" transform="translate(3000,0) scale(1,-1)" font-size="884px" font-family="serif">本</text><text data-variant="normal" transform="translate(4000,0) scale(1,-1)" font-size="884px" font-family="serif">的</text><text data-variant="normal" transform="translate(5000,0) scale(1,-1)" font-size="884px" font-family="serif">权</text><text data-variant="normal" transform="translate(6000,0) scale(1,-1)" font-size="884px" font-family="serif">重</text><text data-variant="normal" transform="translate(7000,0) scale(1,-1)" font-size="884px" font-family="serif">总</text><text data-variant="normal" transform="translate(8000,0) scale(1,-1)" font-size="884px" font-family="serif">和</text></g><rect width="8842.3" height="60" x="120" y="220"/></g></g></g></svg></mjx-container></span></p>
<p>这个例子展示了似然加权如何通过采样和加权来模拟真实的联合概率分布，从而计算出所需的条件概率。</p>
<h3 id="缺点与不足">缺点与不足</h3>
<p>似然加权最大的不足之处是上游变量的值不受下游证据的影响。由于采样过程是前向的（从上游到下游），在对某个变量进行采样时，我们无法利用其子节点（下游）的证据信息。</p>
<p>这意味着如果证据变量位于网络中许多独立的下游节点，每个证据都会使最终的权重呈指数级下降。这可能导致权重变得极小，从而引发数值上的不稳定问题。</p>
<p>同时,
当大多数样本的权重都非常小时，最终的概率估计可能完全由一个或少数几个权重异常大的“幸运”样本决定。这会导致估计的方差很高，结果不稳定。</p>
<p>这个局限性意味着似然加权在进行诊断式推理（从结果推断原因）时效率很低。它生成样本的方式和证据是脱节的，只能在最后通过权重来“亡羊补牢”，这导致了大量的计算浪费。</p>
<details class="blue" data-header-exclude>
    <summary><i class="fa-solid fa-chevron-right"></i>举个栗子 </summary>
    <div class="content markdown-body">
      <p>例如, 让我们构建一个非常简单的贝叶斯网络来模拟交通事故。</p>
<ul>
<li><p>上游变量 (原因): D (司机分心 - Distracted)，可能取值为 T (是) 或
F (否)。</p></li>
<li><p>下游变量 (结果): A (发生事故 - Accident)，可能取值为 T (是) 或 F
(否)。</p></li>
</ul>
<p>此时的网络结构为: D→A (司机分心会导致事故)</p>
<p>假设的概率:</p>
<ul>
<li><p>P(D=T)=0.1 (在正常情况下，司机分心的概率是10%)</p></li>
<li><p>P(A=T∣D=T)=0.6 (如果司机分心，发生事故的概率是60%)</p></li>
<li><p>P(A=T∣D=F)=0.01 (如果司机没分心，发生事故的概率是1%)</p></li>
</ul>
<p>现在，我们有了一个下游证据：确实发生了一场事故
(A=T)。我们的目标是推断上游原因：司机当时分心的概率是多少？即
P(D=T∣A=T)。</p>
<p>从直觉上，既然事故已经发生了，那么司机分心的可能性应该会远高于平时的10%。</p>
<p>现在我们来看似然加权算法是如何一步步处理这个问题的，并观察其局限性。</p>
<p>第1步：采样上游变量 D : 算法开始生成第一个样本。它遇到的第一个变量是
D。算法会问：“我应该如何为 D 采样？”</p>
<p>由于采样过程是纯粹前向的，它完全看不到下游已经发生的事故证据
A=T。它唯一能依据的就是 D 的先验概率分布 P(D)。</p>
<ul>
<li><p>有 10% 的概率，它会采样得到 D=T。</p></li>
<li><p>有 90% 的概率，它会采样得到 D=F。</p></li>
</ul>
<p>这就是问题的核心所在！尽管我们知道事故已经发生，这应该让我们更倾向于相信司机分心了，但算法在采样
D 的时候，完全忽略了这个信息。它依然会花费 90%
的精力去生成“司机没有分心”这种与证据非常不符的样本。</p>
<p>第2步：计算权重</p>
<p>在采样完 D 之后，算法才会考虑证据 A=T，并用它来计算权重。</p>
<ul>
<li><p>情况一 (90%的概率发生): 算法在上一步采样得到 D=F。此时的权重
w=P(A=T∣D=F)=0.01。这是一个极低的权重。</p></li>
<li><p>情况二 (10%的概率发生): 算法在上一步采样得到 D=T。此时的权重
w=P(A=T∣D=T)=0.6。这是一个相对高很多的权重。</p></li>
</ul>
<p>通过上面的过程，我们可以清晰地看到这个局限性体现在哪里：</p>
<ul>
<li><p>盲目采样：算法在生成样本的“构思”阶段是盲目的。它像一个不知道最终结局的编剧，按照通常的概率写故事的开头（采样上游变量）。</p></li>
<li><p>效率低下：算法花费了大量的计算资源（90%的样本）去探索那些几乎不可能导致已知证据（事故）发生的情况（司机没分心）。这些样本最终只会得到一个微不足道的权重，对最终结果的贡献极小。</p></li>
<li><p>结果被“幸运样本”主导：最终的概率估计，几乎完全依赖于那少数（10%）采样到了
D=T
的“幸运样本”。如果样本总数不够多，我们可能采不到足够多的幸运样本，导致最终结果的方差很大，非常不稳定。</p></li>
</ul>

    </div>
  </details>
<h2 id="吉布斯采样-gibbs-sampling">吉布斯采样 (Gibbs Sampling)</h2>
<p>这是一种完全不同的采样策略，属于马尔可夫链蒙特卡洛 (Markov Chain
Monte Carlo - MCMC) 方法的一种。</p>
<blockquote>
<p>为了理解吉布斯采样，首先要理解它所属的 MCMC 方法是什么意思: 蒙特卡洛
(Monte Carlo)指代任何依赖于重复随机采样的算法。而马尔可夫链 (Markov
Chain)指的是一个状态序列，其中下一个状态的概率只取决于当前状态，而与之前的任何状态都无关</p>
</blockquote>
<p>与似然加权那种“一气呵成”的前向采样不同，吉布斯采样的核心思想是迭代式地修正（Iterative
Refinement）。它不试图一次性生成一个完美的样本，而是从一个随机的、不完美的完整状态开始,
通过轮流地、逐个地对变量进行重新采样来不断修正这个状态。在经过足够多的修正后，这个状态就会稳定下来，并开始在真实的目标概率分布附近“徘徊”。此时的状态就可以被当作一个有效的样本。</p>
<p>基本的算法流程如下：</p>
<ol type="1">
<li><p>初始化：从一个随机的完整状态 x
开始（但证据变量的值是固定的）。</p></li>
<li><p>迭代循环：</p>
<ul>
<li><p>选择一个非证据变量 Zᵢ。</p></li>
<li><p>重新采样：将 Zᵢ 的当前值“清空”，然后根据所有其他变量的当前值，为
Zᵢ 重新采样一个新值。这个新值来自于条件概率分布 <span class="math inline"><em>P</em>(<em>Z</em><sub><em>i</em></sub>|mb(<em>Z</em><sub><em>i</em></sub>))</span>，其中
mb(Z_i) 是 Zᵢ 的马尔可夫毯 (Markov
Blanket)（即它的父节点、子节点、以及子节点的其他父节点）。</p></li>
</ul></li>
<li><p>收集样本：每完成一次（或若干次）这样的重采样，当前的状态 x
就被当作一个样本记录下来。</p></li>
</ol>
<p>其优势在于,
吉布斯采样在每次重采样时，都会同时考虑“上游”和“下游”的变量（通过马尔可夫毯），因此信息可以在整个网络中双向传播。这使得它在处理似然加权遇到的“下游证据”问题时通常表现得更好。</p>
<h3 id="示例分析-1">示例分析</h3>
<p>网络结构如下: <span class="math inline"><em>C</em> → <em>S</em></span>, <span class="math inline"><em>C</em> → <em>R</em></span>, <span class="math inline"><em>S</em> → <em>W</em></span>, <span class="math inline"><em>R</em> → <em>W</em></span></p>
<p>查询目标: <span class="math inline"><em>P</em>(<em>C</em> = <em>T</em>|<em>S</em> = <em>T</em>, <em>W</em> = <em>T</em>)</span></p>
<ul>
<li><p>证据变量 (E): <span class="math inline"><em>S</em> = <em>T</em>, <em>W</em> = <em>T</em></span>
(值是固定的)</p></li>
<li><p>非证据变量 (Z): <span class="math inline"><em>C</em>, <em>R</em></span>
(我们需要对它们进行迭代采样)</p></li>
<li><p>概率表 (CPT): 我们继续使用之前例子中的概率。</p></li>
</ul>
<p>吉布斯采样 (Gibbs Sampling) 流程为:</p>
<p>步骤 1: 初始化 - 固定证据: 我们将 S 的值锁定为 T，将 W 的值锁定为
T。</p>
<ul>
<li>随机初始化: 我们为所有非证据变量 <span class="math inline"><em>C</em>, <em>R</em></span> 随机赋一个初始值。
<ul>
<li>比如，我们随机选择 C=F 和
R=F。现在，我们的马尔可夫链的初始状态是：<span class="math inline"><em>C</em> = <em>F</em>, <em>R</em> = <em>F</em>, <em>S</em> = <em>T</em>, <em>W</em> = <em>T</em></span>。</li>
</ul></li>
</ul>
<p>步骤 2: 迭代循环: 我们将轮流对非证据变量 C 和 R 进行重新采样。</p>
<p>首先是第 1 轮迭代</p>
<p>Part A: 重新采样变量 C</p>
<ul>
<li><p>“冻结”其他变量: 将其他所有变量的值固定在当前状态：<span class="math inline"><em>R</em> = <em>F</em>, <em>S</em> = <em>T</em>, <em>W</em> = <em>T</em></span>。</p></li>
<li><p>计算条件概率: 我们需要计算 <span class="math inline"><em>P</em>(<em>C</em>|<em>R</em> = <em>F</em>, <em>S</em> = <em>T</em>, <em>W</em> = <em>T</em>)</span>。</p></li>
</ul>
<p><span class="math inline"><em>P</em>(<em>C</em> = <em>T</em>|...) ∝ <em>P</em>(<em>C</em> = <em>T</em>, <em>R</em> = <em>F</em>, <em>S</em> = <em>T</em>, <em>W</em> = <em>T</em>)</span></p>
<p><span class="math inline"> = <em>P</em>(<em>C</em> = <em>T</em>) ⋅ <em>P</em>(<em>S</em> = <em>T</em>|<em>C</em> = <em>T</em>) ⋅ <em>P</em>(<em>R</em> = <em>F</em>|<em>C</em> = <em>T</em>) ⋅ <em>P</em>(<em>W</em> = <em>T</em>|<em>S</em> = <em>T</em>, <em>R</em> = <em>F</em>)</span></p>
<p><span class="math inline"> = (0.5) ⋅ (0.1) ⋅ (0.2) ⋅ (0.9) = 0.009</span></p>
<p><span class="math inline"><em>P</em>(<em>C</em> = <em>F</em>|...) ∝ <em>P</em>(<em>C</em> = <em>F</em>, <em>R</em> = <em>F</em>, <em>S</em> = <em>T</em>, <em>W</em> = <em>T</em>)</span></p>
<p><span class="math inline"> = <em>P</em>(<em>C</em> = <em>F</em>) ⋅ <em>P</em>(<em>S</em> = <em>T</em>|<em>C</em> = <em>F</em>) ⋅ <em>P</em>(<em>R</em> = <em>F</em>|<em>C</em> = <em>F</em>) ⋅ <em>P</em>(<em>W</em> = <em>T</em>|<em>S</em> = <em>T</em>, <em>R</em> = <em>F</em>)</span></p>
<p><span class="math inline"> = (0.5) ⋅ (0.5) ⋅ (0.8) ⋅ (0.9) = 0.18</span></p>
<p>归一化并采样:</p>
<p><span class="math inline"><em>P</em>(<em>C</em> = <em>T</em>|...) ≈ 0.009/(0.009 + 0.18) ≈ 0.048</span>
(约 5%)</p>
<p><span class="math inline"><em>P</em>(<em>C</em> = <em>F</em>|...) ≈ 0.18/(0.009 + 0.18) ≈ 0.952</span>
(约 95%)</p>
<p>根据这个概率，我们为 C 重新采样。有极大概率我们会采样到
C=F。假设我们这次采样的结果就是 C=F。此时更新状态: 系统的当前状态现在是
<span class="math inline"><em>C</em> = <em>F</em>, <em>R</em> = <em>F</em>, <em>S</em> = <em>T</em>, <em>W</em> = <em>T</em></span>
(这次 C 的值恰好没变)。</p>
<p>Part B: 重新采样变量 R</p>
<ul>
<li><p>“冻结”其他变量: 将其他变量的值固定在当前最新的状态：<span class="math inline"><em>C</em> = <em>F</em>, <em>S</em> = <em>T</em>, <em>W</em> = <em>T</em></span>。</p></li>
<li><p>计算条件概率: 我们需要计算 <span class="math inline"><em>P</em>(<em>R</em>|<em>C</em> = <em>F</em>, <em>S</em> = <em>T</em>, <em>W</em> = <em>T</em>)</span>。</p></li>
</ul>
<p><span class="math inline"><em>P</em>(<em>R</em> = <em>T</em>|...) ∝ <em>P</em>(<em>R</em> = <em>T</em>|<em>C</em> = <em>F</em>) ⋅ <em>P</em>(<em>W</em> = <em>T</em>|<em>S</em> = <em>T</em>, <em>R</em> = <em>T</em>)</span></p>
<p><span class="math inline"> = (0.2) ⋅ (0.99) = 0.198</span></p>
<p><span class="math inline"><em>P</em>(<em>R</em> = <em>F</em>|...) ∝ <em>P</em>(<em>R</em> = <em>F</em>|<em>C</em> = <em>F</em>) ⋅ <em>P</em>(<em>W</em> = <em>T</em>|<em>S</em> = <em>T</em>, <em>R</em> = <em>F</em>)</span></p>
<p><span class="math inline"> = (0.8) ⋅ (0.9) = 0.72</span></p>
<p>归一化并采样:</p>
<p><span class="math inline"><em>P</em>(<em>R</em> = <em>T</em>|...) ≈ 0.198/(0.198 + 0.72) ≈ 0.216</span>
(约 22%)</p>
<p><span class="math inline"><em>P</em>(<em>R</em> = <em>F</em>|...) ≈ 0.72/(0.198 + 0.72) ≈ 0.784</span>
(约 78%)</p>
<p>根据这个概率，我们为 R 重新采样。假设这次我们采样的结果是
R=F。然后更新状态: 第1轮迭代结束，系统的最终状态是 <span class="math inline"><em>C</em> = <em>F</em>, <em>R</em> = <em>F</em>, <em>S</em> = <em>T</em>, <em>W</em> = <em>T</em></span>。</p>
<p>在之后的第 2 轮迭代 (及后续)中,
我们会重复上面的过程。在第2轮迭代开始时，我们会先重新采样
C，此时它将基于 <span class="math inline"><em>R</em> = <em>F</em>, <em>S</em> = <em>T</em>, <em>W</em> = <em>T</em></span>
来计算条件概率（与第一轮相同）。然后，我们会根据新采样的 C
值和固定的证据，再次为 R 重新采样。</p>
<p>随着迭代的进行，状态 <span class="math inline"><em>C</em>, <em>R</em></span>
会不断在各种可能的值之间跳转，但跳转的频率会符合它们在证据 <span class="math inline"><em>S</em> = <em>T</em>, <em>W</em> = <em>T</em></span>
下的真实后验概率。</p>
<p>步骤 3: 收集样本并得出结论</p>
<p>在经过足够长的”热身”期后，我们开始记录每一轮迭代结束时的状态。例如，我们可能收集到以下10,000个样本（只记录非证据变量）：</p>
<p><span class="math inline"><em>C</em> = <em>F</em>, <em>R</em> = <em>F</em></span></p>
<p><span class="math inline"><em>C</em> = <em>F</em>, <em>R</em> = <em>F</em></span></p>
<p><span class="math inline"><em>C</em> = <em>F</em>, <em>R</em> = <em>T</em></span></p>
<p>…</p>
<p><span class="math inline"><em>C</em> = <em>T</em>, <em>R</em> = <em>T</em></span></p>
<p>…</p>
<p>最后，我们要回答查询 <span class="math inline"><em>P</em>(<em>C</em> = <em>T</em>|<em>S</em> = <em>T</em>, <em>W</em> = <em>T</em>)</span>。我们只需要在收集到的10,000个样本中，计算出
C=T 的样本所占的比例即可</p>
<p>理论证明,
只要这个过程重复足够多次，算法生成的样本分布最终会收敛到真实的后验概率分布
<span class="math inline"><em>P</em>(<em>Q</em>|<em>e</em>)</span>。</p>

		</div>

		

		
		<ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
			
			<li class="tag-item mx-0.5">
				<a href="/tags/AI/">#AI</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/CS188/">#CS188</a>&nbsp;
			</li>
			
		</ul>
		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/2025/08/25/ai/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BDAI/CS188/14/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item truncate max-w-48">HMMs -- Markov Chains, HMMs(14)</span>
						<span class="post-nav-item">Prev posts</span>
					</span>
				</a>
			</div>
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/2025/08/23/ai/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BDAI/CS188/12/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item truncate max-w-48">Bayes Nets -- Inference(12)</span>
						<span class="post-nav-item">Next posts</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">On this page</div>
		<div class="page-title">Bayes Nets -- Sampling(13)</div>
		<ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%88%E9%AA%8C%E9%87%87%E6%A0%B7-prior-sampling%E5%92%8C%E6%8B%92%E7%BB%9D%E9%87%87%E6%A0%B7-rejection-sampling"><span class="nav-text">先验采样
(Prior Sampling)和拒绝采样 (Rejection Sampling)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%BC%E7%84%B6%E5%8A%A0%E6%9D%83-likelihood-weighting"><span class="nav-text">似然加权 (Likelihood
Weighting)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E7%90%86%E6%8E%A8%E5%AF%BC"><span class="nav-text">原理推导</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%E5%88%86%E6%9E%90"><span class="nav-text">示例分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%BA%E7%82%B9%E4%B8%8E%E4%B8%8D%E8%B6%B3"><span class="nav-text">缺点与不足</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%89%E5%B8%83%E6%96%AF%E9%87%87%E6%A0%B7-gibbs-sampling"><span class="nav-text">吉布斯采样 (Gibbs Sampling)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%E5%88%86%E6%9E%90-1"><span class="nav-text">示例分析</span></a></li></ol></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
            <div class="customize-info my-1">AI是新时代的灯塔</div>
        
        <div class="text-center">
            &copy;
            
              <span>2025</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">ZaynPei</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        186 posts in total
                    </span>
                    
                        <span>
                            578.6k words in total
                        </span>
                    
                </p>
            
        </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.5</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
            
                
        
                
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="arrow-up fas fa-arrow-up"></i>
			<span class="percent"></span>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	
	<div class="search-pop-overlay">
	<div class="popup search-popup">
		<div class="search-header">
			<span class="search-input-field-pre">
				<i class="fa-solid fa-keyboard"></i>
			</span>
			<div class="search-input-container">
				<input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input">
			</div>
			<span class="popup-btn-close">
				<i class="fa-solid fa-times"></i>
			</span>
		</div>
		<div id="search-result">
			<div id="no-result">
				<i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
			</div>
		</div>
	</div>
</div>
	

</main>



<script src="/js/build/libs/Swup.min.js"></script>

<script src="/js/build/libs/SwupSlideTheme.min.js"></script>

<script src="/js/build/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/build/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/build/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/build/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	
<script src="/js/build/tools/imageViewer.js" type="module"></script>

<script src="/js/build/utils.js" type="module"></script>

<script src="/js/build/main.js" type="module"></script>

<script src="/js/build/layouts/navbarShrink.js" type="module"></script>

<script src="/js/build/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/build/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/build/layouts/categoryList.js" type="module"></script>



    
<script src="/js/build/tools/localSearch.js" type="module"></script>




    
<script src="/js/build/tools/codeBlock.js" type="module"></script>




    
<script src="/js/build/layouts/lazyload.js" type="module"></script>




    
<script src="/js/build/tools/runtime.js"></script>

    
<script src="/js/build/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/build/libs/Typed.min.js"></script>

  
<script src="/js/build/plugins/typed.js" type="module"></script>








    
<script src="/js/build/libs/anime.min.js"></script>





    
<script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script>





	
</body>

</html>